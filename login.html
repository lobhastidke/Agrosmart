<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AgroSmart - Maharashtra Crop Recommendation System</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link
        href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&family=Roboto+Slab:wght@400;500;600&display=swap"
        rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&amp;display=swap"
        rel="stylesheet" />
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght@100..700,0..1&amp;display=swap"
        rel="stylesheet" />
    <link
        href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght,FILL@100..700,0..1&amp;display=swap"
        rel="stylesheet" />
    <script id="tailwind-config">
        tailwind.config = {
            darkMode: "class",
            theme: {
                extend: {
                    colors: {
                        "primary": "#2ecc70",
                        "background-light": "#f9fafb",
                        "background-dark": "#131f18",
                    },
                    fontFamily: {
                        "display": ["Inter", "sans-serif"]
                    },
                    borderRadius: {
                        "DEFAULT": "0.5rem",
                        "lg": "1rem",
                        "xl": "1.5rem",
                        "full": "9999px"
                    },
                    boxShadow: {
                        'premium': '0 10px 25px -5px rgba(0, 0, 0, 0.04), 0 8px 10px -6px rgba(0, 0, 0, 0.04)',
                        'glow': '0 0 20px rgba(46, 204, 112, 0.25)',
                    }
                },
            },
        }
    </script>
    <style>
        /* ========== COMPLETE CSS WITH ALL FIXES ========== */
        :root {
            --primary-green: #2e7d32;
            --light-green: #4caf50;
            --dark-green: #1b5e20;
            --earth-brown: #8d6e63;
            --light-brown: #d7ccc8;
            --wheat: #ffd54f;
            --cream: #f9f7f2;
            --text-dark: #333333;
            --text-light: #666666;
            --shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
            --transition: all 0.3s ease;
            --white: #ffffff;
            --gray-100: #f8f9fa;
            --gray-200: #e9ecef;
            --gray-300: #dee2e6;
            --gray-400: #ced4da;
            --gray-500: #adb5bd;
            --gray-600: #6c757d;
            --gray-700: #495057;
            --danger: #dc3545;
            --danger-dark: #c82333;
            --info: #17a2b8;
            --info-dark: #138496;
            --orange: #ff9800;
            --orange-light: #fff3e0;
            --yellow-light: #fff9e6;
        }

        .material-symbols-outlined {
            font-variation-settings: 'FILL' 0, 'wght' 400, 'GRAD' 0, 'opsz' 24;
        }

        .bg-gradient-green {
            background: linear-gradient(135deg, #2ecc70 0%, #27ae60 100%);
        }

        .glass-effect {
            backdrop-filter: blur(10px);
            background: rgba(255, 255, 255, 0.8);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Poppins', sans-serif;
            line-height: 1.6;
            color: var(--text-dark);
            background-color: #f5f7fa;
            min-height: 100vh;
        }

        /* ========== LOGIN PAGE ========== */
        .login-page {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            background: linear-gradient(135deg, #1b5e20 0%, #2e7d32 50%, #4caf50 100%);
            position: relative;
            overflow: hidden;
        }

        .login-page::before {
            content: '';
            position: absolute;
            width: 200%;
            height: 200%;
            background: rgba(255, 255, 255, 0.05);
            transform: rotate(45deg);
            top: -50%;
            left: -50%;
            animation: shine 15s infinite linear;
        }

        @keyframes shine {
            0% {
                transform: rotate(45deg) translateX(-50%);
            }

            100% {
                transform: rotate(45deg) translateX(50%);
            }
        }

        .login-container {
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            width: 90%;
            max-width: 450px;
            padding: 40px;
            position: relative;
            z-index: 10;
            animation: slideUp 0.6s ease;
        }

        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .login-header {
            text-align: center;
            margin-bottom: 40px;
        }

        .login-logo {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            font-family: 'Roboto Slab', serif;
            font-size: 2.2rem;
            font-weight: 600;
            color: var(--primary-green);
            margin-bottom: 15px;
        }

        .login-logo i {
            color: var(--wheat);
            font-size: 2.5rem;
        }

        .login-title {
            font-size: 1.8rem;
            color: var(--dark-green);
            margin-bottom: 10px;
        }

        .login-subtitle {
            color: var(--text-light);
            font-size: 0.95rem;
        }

        .login-form {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .input-group {
            position: relative;
        }

        .input-group i {
            position: absolute;
            left: 15px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--text-light);
            font-size: 1.1rem;
        }

        .login-input {
            width: 100%;
            padding: 15px 15px 15px 45px;
            border: 2px solid #e0e0e0;
            border-radius: 12px;
            font-family: 'Poppins', sans-serif;
            font-size: 1rem;
            transition: var(--transition);
        }

        .login-input:focus {
            outline: none;
            border-color: var(--light-green);
            box-shadow: 0 0 0 3px rgba(76, 175, 80, 0.1);
        }

        .login-btn {
            background: linear-gradient(135deg, var(--light-green), var(--primary-green));
            color: white;
            border: none;
            padding: 15px;
            border-radius: 12px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .login-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(46, 125, 50, 0.3);
        }

        .login-footer {
            margin-top: 30px;
            text-align: center;
            color: var(--text-light);
        }

        .error-message {
            background: #ffebee;
            color: #c62828;
            padding: 12px;
            border-radius: 8px;
            font-size: 0.9rem;
            display: flex;
            align-items: center;
            gap: 8px;
            display: none;
        }

        .error-message.show {
            display: flex;
        }

        .login-language-switcher {
            display: flex;
            gap: 5px;
            background: rgba(255, 255, 255, 0.9);
            border-radius: 50px;
            padding: 5px;
            margin-bottom: 30px;
            justify-content: center;
        }

        .login-lang-btn {
            background: transparent;
            border: none;
            color: var(--text-dark);
            padding: 6px 15px;
            border-radius: 50px;
            font-family: 'Poppins', sans-serif;
            font-size: 0.85rem;
            cursor: pointer;
            transition: var(--transition);
        }

        .login-lang-btn:hover {
            background: rgba(46, 125, 50, 0.1);
        }

        .login-lang-btn.active {
            background: var(--primary-green);
            color: white;
        }

        /* ========== MAIN APP ========== */
        .main-app {
            display: none;
        }

        .main-app.authenticated {
            display: block;
        }

        header {
            background-color: var(--primary-green);
            color: white;
            padding: 15px 0;
            box-shadow: var(--shadow);
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .header-content {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .header-left {
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .profile-circle {
            width: 45px;
            height: 45px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--wheat), #ffb74d);
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: var(--transition);
            border: 2px solid white;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
        }

        .profile-circle:hover {
            transform: scale(1.1);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
        }

        .profile-circle i {
            font-size: 1.8rem;
            color: white;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 10px;
            font-family: 'Roboto Slab', serif;
            font-size: 1.8rem;
            font-weight: 600;
        }

        .logo i {
            color: var(--wheat);
            font-size: 2.2rem;
        }

        .nav-controls {
            display: flex;
            gap: 15px;
            align-items: center;
            flex-wrap: wrap;
        }

        .btn {
            padding: 10px 24px;
            border: none;
            border-radius: 50px;
            font-family: 'Poppins', sans-serif;
            font-weight: 500;
            cursor: pointer;
            transition: var(--transition);
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .btn-primary {
            background-color: var(--light-green);
            color: white;
        }

        .btn-primary:hover {
            background-color: var(--dark-green);
            transform: translateY(-2px);
            box-shadow: var(--shadow);
        }

        .btn-secondary {
            background-color: white;
            color: var(--primary-green);
            border: 1px solid var(--primary-green);
        }

        .btn-secondary:hover {
            background-color: #f0f9f0;
        }

        .btn-calculate {
            background-color: var(--wheat);
            color: var(--dark-green);
            font-weight: 600;
        }

        .btn-calculate:hover {
            background-color: #ffca28;
            transform: translateY(-2px);
            box-shadow: var(--shadow);
        }

        .btn-danger {
            background-color: var(--danger);
            color: white;
        }

        .btn-danger:hover {
            background-color: var(--danger-dark);
        }

        .btn-info {
            background-color: var(--info);
            color: white;
        }

        .btn-info:hover {
            background-color: var(--info-dark);
        }

        .btn-generate {
            background: linear-gradient(135deg, var(--wheat), #ffb74d);
            color: var(--dark-green);
            font-weight: 600;
            padding: 14px 28px;
            font-size: 1.1rem;
        }

        .btn-generate:hover {
            background: linear-gradient(135deg, #ffb74d, var(--wheat));
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(255, 193, 7, 0.3);
        }

        .logout-header-btn {
            background: rgba(255, 255, 255, 0.2);
            color: white;
            border: 1px solid rgba(255, 255, 255, 0.3);
            padding: 8px 16px;
            border-radius: 50px;
            font-size: 0.9rem;
            font-weight: 500;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .logout-header-btn:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: translateY(-2px);
        }

        .language-switcher {
            display: flex;
            gap: 5px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 50px;
            padding: 5px;
        }

        .lang-btn {
            background: transparent;
            border: none;
            color: white;
            padding: 6px 15px;
            border-radius: 50px;
            font-family: 'Poppins', sans-serif;
            font-size: 0.85rem;
            cursor: pointer;
            transition: var(--transition);
        }

        .lang-btn:hover {
            background: rgba(255, 255, 255, 0.2);
        }

        .lang-btn.active {
            background: white;
            color: var(--primary-green);
            font-weight: 500;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            padding-bottom: 80px;
        }

        .dashboard-page {
            display: none;
            animation: fadeIn 0.5s ease;
        }

        .dashboard-page.active {
            display: block;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .page-title {
            font-family: 'Roboto Slab', serif;
            font-size: 2.2rem;
            color: var(--primary-green);
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .page-title i {
            color: var(--earth-brown);
        }

        .page-description {
            color: var(--text-light);
            font-size: 1.1rem;
            margin-bottom: 30px;
            max-width: 800px;
        }

        .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 25px;
            margin-top: 20px;
        }

        .dashboard-card {
            background-color: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: var(--shadow);
            transition: var(--transition);
        }

        .dashboard-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .card-title {
            font-size: 1.4rem;
            color: var(--dark-green);
            font-weight: 600;
        }

        .card-icon {
            width: 50px;
            height: 50px;
            border-radius: 12px;
            background-color: rgba(76, 175, 80, 0.1);
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--primary-green);
            font-size: 1.5rem;
        }

        .welcome-card {
            grid-column: 1 / -1;
            background: linear-gradient(135deg, var(--primary-green), var(--light-green));
            color: white;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .welcome-content h1 {
            font-size: 2.2rem;
            margin-bottom: 10px;
        }

        .welcome-content p {
            opacity: 0.9;
            max-width: 600px;
            margin-bottom: 20px;
        }

        .welcome-image {
            font-size: 6rem;
            opacity: 0.8;
        }

        .stats-card {
            text-align: center;
            background: linear-gradient(135deg, #ffffff, #f5f5f5);
            border: 1px solid #e0e0e0;
        }

        .stats-value {
            font-size: 3rem;
            font-weight: 700;
            color: var(--primary-green);
            margin: 10px 0 5px;
            line-height: 1.2;
        }

        .stats-label {
            color: var(--text-dark);
            font-size: 1rem;
            font-weight: 500;
        }

        .stats-label small {
            color: var(--text-light);
            font-size: 0.85rem;
            display: block;
            margin-top: 5px;
        }

        .feature-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin: 40px 0;
        }

        .feature-card {
            background: white;
            border-radius: 15px;
            padding: 25px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
            border: 2px solid transparent;
        }

        .feature-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.12);
            border-color: var(--light-green);
        }

        .feature-icon {
            width: 70px;
            height: 70px;
            margin: 0 auto 15px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--light-green), var(--primary-green));
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.8rem;
        }

        .feature-title {
            font-size: 1.3rem;
            color: var(--dark-green);
            margin-bottom: 10px;
            font-weight: 600;
        }

        .feature-description {
            color: var(--text-light);
            font-size: 0.95rem;
            margin-bottom: 15px;
        }

        /* ========== SEARCHABLE DROPDOWNS ========== */
        .select-wrapper {
            position: relative;
            width: 100%;
        }

        .select-wrapper select {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-family: 'Poppins', sans-serif;
            font-size: 1rem;
            appearance: none;
            background-color: white;
            cursor: pointer;
        }

        .select-wrapper i {
            position: absolute;
            right: 15px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--text-light);
            pointer-events: none;
        }

        .searchable-select-container {
            position: relative;
            width: 100%;
        }

        .searchable-select-input {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-family: 'Poppins', sans-serif;
            font-size: 1rem;
            background-color: white;
        }

        .searchable-select-input:focus {
            outline: none;
            border-color: var(--light-green);
            box-shadow: 0 0 0 3px rgba(76, 175, 80, 0.1);
        }

        .searchable-dropdown {
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            max-height: 200px;
            overflow-y: auto;
            background: white;
            border: 2px solid #e0e0e0;
            border-top: none;
            border-radius: 0 0 8px 8px;
            z-index: 1000;
            display: none;
        }

        .searchable-dropdown.active {
            display: block;
        }

        .searchable-option {
            padding: 10px 15px;
            cursor: pointer;
            transition: var(--transition);
        }

        .searchable-option:hover {
            background-color: #f0f9f0;
        }

        .searchable-option.selected {
            background-color: var(--light-green);
            color: white;
        }

        /* ========== QUICK ANALYSIS PAGE ========== */
        .quick-analysis-container {
            background: white;
            border-radius: 15px;
            padding: 40px;
            box-shadow: var(--shadow);
            margin-top: 20px;
            text-align: center;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
        }

        .quick-analysis-container h2 {
            color: var(--dark-green);
            font-family: 'Roboto Slab', serif;
            font-size: 2rem;
            margin-bottom: 15px;
        }

        .quick-analysis-container p {
            color: var(--text-light);
            margin-bottom: 30px;
        }

        .quick-analysis-form {
            display: flex;
            flex-direction: column;
            gap: 20px;
            max-width: 400px;
            margin: 0 auto;
        }

        .quick-analysis-form .form-group {
            text-align: left;
        }

        .quick-analysis-form .form-label {
            font-weight: 600;
            color: var(--dark-green);
            margin-bottom: 8px;
            display: block;
        }

        .quick-analysis-form .btn {
            width: 100%;
            padding: 14px;
            font-size: 1.1rem;
            margin-top: 10px;
        }

        .back-btn {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            background-color: #f5f5f5;
            color: var(--text-dark);
            padding: 10px 20px;
            border-radius: 50px;
            text-decoration: none;
            font-weight: 500;
            transition: var(--transition);
            margin-bottom: 20px;
            border: none;
            cursor: pointer;
            font-family: 'Poppins', sans-serif;
        }

        .back-btn:hover {
            background-color: #e0e0e0;
            transform: translateX(-5px);
        }

        /* ========== DISTRICT DETAILS PAGE ========== */
        .district-details {
            background-color: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: var(--shadow);
            margin-top: 20px;
        }

        .details-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 1px solid #eee;
        }

        .district-title {
            font-family: 'Roboto Slab', serif;
            font-size: 1.8rem;
            color: var(--dark-green);
        }

        /* ========== INPUT FORM STYLES ========== */
        .input-form-section {
            background: #f9f9f9;
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 30px;
            border: 1px solid #e0e0e0;
        }

        .input-form-section h3 {
            color: var(--dark-green);
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 1.3rem;
        }

        .input-form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }

        .full-width {
            grid-column: 1 / -1;
        }

        /* ========== RECOMMENDATION REPORT STYLES ========== */
        .recommendation-report {
            background: white;
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 30px;
            border: 2px solid var(--light-green);
            box-shadow: var(--shadow);
        }

        .report-header {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px dashed var(--light-green);
        }

        .report-header i {
            font-size: 2rem;
            color: var(--wheat);
        }

        .report-header h2 {
            font-size: 1.6rem;
            color: var(--dark-green);
            font-weight: 600;
        }

        .report-header .risk-badge {
            background: #ff9800;
            color: white;
            padding: 5px 15px;
            border-radius: 50px;
            font-size: 0.9rem;
            font-weight: 600;
            margin-left: auto;
        }

        .location-summary {
            background: #f0f7f0;
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 25px;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            border-left: 5px solid var(--light-green);
        }

        .location-item {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .location-item i {
            width: 24px;
            color: var(--light-green);
            font-size: 1.2rem;
        }

        .location-item strong {
            color: var(--dark-green);
            margin-right: 5px;
        }

        .section-title {
            color: var(--dark-green);
            margin: 25px 0 15px;
            font-size: 1.3rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .section-title i {
            color: var(--wheat);
        }

        .crops-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 25px;
        }

        .crop-card {
            background: #f9f9f9;
            border-radius: 12px;
            padding: 20px;
            border: 1px solid #e0e0e0;
            transition: var(--transition);
            position: relative;
            overflow: hidden;
        }

        .crop-card:hover {
            transform: translateY(-3px);
            box-shadow: var(--shadow);
            border-color: var(--light-green);
        }

        .crop-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 5px;
            height: 100%;
            background: linear-gradient(135deg, var(--light-green), var(--dark-green));
        }

        .crop-rank {
            display: inline-block;
            background: var(--light-green);
            color: white;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            text-align: center;
            line-height: 30px;
            font-weight: 600;
            margin-bottom: 10px;
        }

        .crop-name {
            font-size: 1.3rem;
            color: var(--dark-green);
            font-weight: 600;
            margin-bottom: 10px;
        }

        .crop-detail {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
            font-size: 0.95rem;
        }

        .crop-detail .label {
            color: var(--text-light);
        }

        .crop-detail .value {
            font-weight: 600;
            color: var(--text-dark);
        }

        .risk-badge-low,
        .risk-badge-medium,
        .risk-badge-high {
            padding: 3px 10px;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 600;
            display: inline-block;
        }

        .risk-badge-low {
            background: #e8f5e9;
            color: #2e7d32;
        }

        .risk-badge-medium {
            background: #fff3e0;
            color: #ef6c00;
        }

        .risk-badge-high {
            background: #ffebee;
            color: #c62828;
        }

        .alerts-list {
            display: flex;
            flex-direction: column;
            gap: 12px;
            margin-top: 15px;
        }

        .alert-item {
            padding: 15px 20px;
            border-radius: 10px;
            display: flex;
            align-items: center;
            gap: 12px;
            font-size: 0.95rem;
        }

        .alert-orange {
            background: var(--orange-light);
            border-left: 5px solid var(--orange);
        }

        .alert-yellow {
            background: var(--yellow-light);
            border-left: 5px solid #ffc107;
        }

        .alert-item i {
            font-size: 1.2rem;
        }

        .alert-orange i {
            color: var(--orange);
        }

        .alert-yellow i {
            color: #ffc107;
        }

        /* ========== MAP AND YOUTUBE SECTIONS ========== */
        .upload-section,
        .youtube-section {
            margin: 25px 0;
            padding: 20px;
            background: #f9f9f9;
            border-radius: 10px;
        }

        .upload-title {
            color: var(--dark-green);
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .upload-placeholder,
        .video-placeholder {
            min-height: 200px;
            background: white;
            border-radius: 10px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 30px;
            text-align: center;
            border: 2px solid #eee;
        }

        .upload-placeholder i,
        .video-placeholder i {
            font-size: 3rem;
            color: #ddd;
            margin-bottom: 15px;
        }

        .video-placeholder i {
            color: #ff0000;
        }

        /* ========== CALCULATOR STYLES ========== */
        .profit-calculator,
        .calculator-page {
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: var(--shadow);
            margin-top: 30px;
        }

        .calculator-header {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 25px;
        }

        .calculator-header i {
            color: var(--primary-green);
            font-size: 2rem;
        }

        .calculator-title {
            font-family: 'Roboto Slab', serif;
            font-size: 1.8rem;
            color: var(--dark-green);
        }

        .calculator-subtitle {
            color: var(--text-light);
            font-size: 1rem;
            margin-top: 5px;
        }

        .calculator-tabs,
        .calculator-tabs-container {
            display: flex;
            border-bottom: 2px solid #eee;
            margin-bottom: 25px;
            flex-wrap: wrap;
        }

        .tab-btn {
            padding: 12px 25px;
            background: none;
            border: none;
            font-family: 'Poppins', sans-serif;
            font-size: 1rem;
            font-weight: 500;
            color: var(--text-light);
            cursor: pointer;
            transition: var(--transition);
            border-bottom: 3px solid transparent;
        }

        .tab-btn.active {
            color: var(--primary-green);
            border-bottom-color: var(--primary-green);
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
            animation: fadeIn 0.3s ease;
        }

        .calculator-form {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .calculator-actions {
            display: flex;
            gap: 15px;
            margin-top: 25px;
            flex-wrap: wrap;
        }

        .calculator-results {
            background-color: #f9f9f9;
            border-radius: 10px;
            padding: 25px;
            margin-top: 30px;
        }

        .results-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .results-title {
            font-size: 1.4rem;
            color: var(--dark-green);
            font-weight: 600;
        }

        .profit-badge {
            padding: 8px 15px;
            border-radius: 20px;
            font-weight: 600;
            font-size: 1rem;
        }

        .profit-positive {
            background-color: #e8f5e9;
            color: var(--dark-green);
        }

        .profit-negative {
            background-color: #ffebee;
            color: #c62828;
        }

        .results-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 25px;
        }

        .result-item {
            background-color: white;
            border-radius: 10px;
            padding: 20px;
            text-align: center;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05);
        }

        .result-label {
            font-size: 0.95rem;
            color: var(--text-light);
            margin-bottom: 8px;
        }

        .result-value {
            font-size: 1.8rem;
            font-weight: 700;
            color: var(--dark-green);
        }

        .result-value.negative {
            color: #c62828;
        }

        /* ========== COMPARE CROPS TABLE ========== */
        .compare-crops-section {
            background: #f9f9f9;
            border-radius: 10px;
            padding: 20px;
            margin-top: 20px;
        }

        .crop-comparison-controls {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .crop-comparison-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }

        .crop-comparison-table th {
            background: #e8f5e9;
            padding: 15px;
            text-align: left;
            font-weight: 600;
            color: var(--dark-green);
            border-bottom: 2px solid #ddd;
        }

        .crop-comparison-table td {
            padding: 12px 15px;
            border-bottom: 1px solid #eee;
        }

        .crop-comparison-table tr:hover {
            background: #f5f5f5;
        }

        /* ========== MARKET TABLE ========== */
        .market-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }

        .market-table th {
            background: #e8f5e9;
            padding: 12px;
            text-align: left;
            font-weight: 600;
            color: var(--dark-green);
        }

        .market-table td {
            padding: 10px 12px;
            border-bottom: 1px solid #eee;
        }

        .market-table tr:hover {
            background: #f5f5f5;
        }

        .price-up {
            color: #4caf50;
            font-weight: 600;
        }

        .price-down {
            color: #f44336;
            font-weight: 600;
        }

        .price-stable {
            color: #ff9800;
            font-weight: 600;
        }

        /* ========== GOVERNMENT SCHEMES ========== */

        .schemes-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 25px;
            margin-top: 20px;
        }

        .scheme-card {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: var(--shadow);
            transition: var(--transition);
            border: 1px solid #e0e0e0;
        }

        .scheme-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
            border-color: var(--light-green);
        }

        .scheme-icon {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--light-green), var(--primary-green));
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.8rem;
            margin-bottom: 15px;
        }

        .scheme-title {
            font-size: 1.3rem;
            color: var(--dark-green);
            margin-bottom: 10px;
            font-weight: 600;
        }

        .scheme-description {
            color: var(--text-light);
            font-size: 0.95rem;
            margin-bottom: 15px;
        }

        .scheme-benefits {
            background: #f9f9f9;
            padding: 12px;
            border-radius: 8px;
            margin: 15px 0;
            font-size: 0.95rem;
        }

        .scheme-benefits strong {
            color: var(--dark-green);
        }

        /* ========== SEARCH CONTAINER ========== */
        .search-container {
            background: white;
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 25px;
            box-shadow: var(--shadow);
        }

        .search-box {
            position: relative;
        }

        .search-input {
            width: 100%;
            padding: 15px 20px 15px 50px;
            border: 2px solid #e0e0e0;
            border-radius: 50px;
            font-family: 'Poppins', sans-serif;
            font-size: 1rem;
            transition: var(--transition);
        }

        .search-input:focus {
            outline: none;
            border-color: var(--light-green);
            box-shadow: 0 0 0 3px rgba(76, 175, 80, 0.1);
        }

        .search-icon {
            position: absolute;
            left: 20px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--text-light);
            font-size: 1.2rem;
        }

        .search-clear {
            position: absolute;
            right: 20px;
            top: 50%;
            transform: translateY(-50%);
            background: none;
            border: none;
            color: var(--text-light);
            cursor: pointer;
            font-size: 1.2rem;
        }

        .search-clear:hover {
            color: var(--primary-green);
        }

        .search-info {
            margin-top: 10px;
            color: var(--text-light);
            font-size: 0.95rem;
            display: flex;
            justify-content: space-between;
        }

        /* ========== PROFILE PAGE ========== */
        .profile-content {
            background: white;
            border-radius: 15px;
            padding: 40px;
            box-shadow: var(--shadow);
            margin-top: 20px;
        }

        .profile-header {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin-bottom: 30px;
        }

        .profile-avatar {
            width: 100px;
            height: 100px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--light-green), var(--primary-green));
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 15px;
            border: 3px solid white;
            box-shadow: var(--shadow);
        }

        .profile-avatar i {
            font-size: 3rem;
            color: white;
        }

        .profile-name {
            font-size: 1.8rem;
            color: var(--dark-green);
            font-weight: 600;
        }

        .profile-email {
            color: var(--text-light);
            font-size: 1rem;
        }

        .farmer-profile-section {
            background: #f9f9f9;
            border-radius: 15px;
            padding: 30px;
            margin: 30px 0;
        }

        .farmer-profile-section h3 {
            color: var(--dark-green);
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .profile-form {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .form-group {
            display: flex;
            flex-direction: column;
        }

        .form-label {
            font-weight: 500;
            margin-bottom: 8px;
            color: var(--text-dark);
        }

        .form-input {
            padding: 12px 15px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-family: 'Poppins', sans-serif;
            font-size: 1rem;
            transition: var(--transition);
            background-color: white;
        }

        .form-input:focus {
            outline: none;
            border-color: var(--light-green);
            box-shadow: 0 0 0 3px rgba(76, 175, 80, 0.1);
        }

        .saved-info-card {
            background: white;
            border-radius: 15px;
            padding: 25px;
            margin-top: 30px;
            border: 2px solid var(--light-green);
            box-shadow: var(--shadow);
        }

        .saved-info-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }

        .info-item {
            padding: 15px;
            background: #f5f5f5;
            border-radius: 10px;
            border-left: 4px solid var(--light-green);
        }

        .info-label {
            font-size: 0.9rem;
            color: var(--text-light);
            margin-bottom: 5px;
        }

        .info-value {
            font-size: 1.2rem;
            font-weight: 600;
            color: var(--dark-green);
        }

        .action-buttons {
            display: flex;
            gap: 15px;
            margin-top: 25px;
            flex-wrap: wrap;
        }

        .profile-logout-btn {
            margin-top: 30px;
            background: linear-gradient(135deg, #f44336, #d32f2f);
            color: white;
            border: none;
            padding: 14px 32px;
            border-radius: 50px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 12px;
            box-shadow: 0 4px 15px rgba(244, 67, 54, 0.3);
        }

        .profile-logout-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(244, 67, 54, 0.4);
        }

        /* ========== GRAPH STYLES ========== */
        .graph-container {
            background: white;
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 30px;
            box-shadow: var(--shadow);
            border: 1px solid #e0e0e0;
        }

        .graph-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            flex-wrap: wrap;
            gap: 15px;
        }

        .graph-title {
            font-size: 1.4rem;
            color: var(--dark-green);
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .graph-title i {
            color: var(--wheat);
        }

        .graph-controls {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .graph-wrapper {
            height: 350px;
            position: relative;
            margin-bottom: 20px;
        }

        .data-entry-form {
            background: #f9f9f9;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
            border: 1px dashed var(--light-green);
        }

        .data-entry-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            align-items: end;
        }

        .graph-analysis {
            margin-top: 20px;
            padding: 20px;
            background: #e8f5e9;
            border-radius: 10px;
            border-left: 5px solid var(--dark-green);
        }

        .analysis-stats {
            display: flex;
            gap: 20px;
            flex-wrap: wrap;
            justify-content: space-around;
        }

        .stat-item {
            flex: 1;
            min-width: 120px;
            text-align: center;
            padding: 15px;
            background: white;
            border-radius: 10px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
        }

        .stat-label {
            font-size: 0.9rem;
            color: var(--text-light);
            margin-bottom: 8px;
        }

        .stat-value {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--dark-green);
        }

        .data-list {
            margin-top: 20px;
        }

        .data-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 20px;
            background: #f9f9f9;
            border-radius: 10px;
            margin-bottom: 10px;
            border: 1px solid #e0e0e0;
            transition: all 0.3s ease;
        }

        .data-item:hover {
            background: #f0f0f0;
            transform: translateX(5px);
        }

        .data-info {
            display: flex;
            gap: 25px;
            flex-wrap: wrap;
        }

        .data-info span {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 1rem;
        }

        .data-info i {
            color: var(--light-green);
            width: 20px;
        }

        .delete-btn {
            background: none;
            border: none;
            color: var(--danger);
            cursor: pointer;
            font-size: 1.3rem;
            padding: 8px 15px;
            border-radius: 8px;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .delete-btn:hover {
            background: var(--danger);
            color: white;
            transform: scale(1.1);
        }

        /* ========== CHATBOT ========== */
        .chatbot-container {
            position: fixed;
            bottom: 25px;
            right: 25px;
            z-index: 1000;
            font-family: 'Poppins', sans-serif;
        }

        .chatbot-btn {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--light-green), var(--primary-green));
            color: white;
            border: none;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2rem;
            box-shadow: 0 6px 20px rgba(46, 125, 50, 0.4);
            transition: var(--transition);
            position: relative;
        }

        .chatbot-btn:hover {
            transform: scale(1.1);
            box-shadow: 0 8px 25px rgba(46, 125, 50, 0.6);
        }

        .chatbot-btn::after {
            content: '';
            position: absolute;
            top: -5px;
            left: -5px;
            right: -5px;
            bottom: -5px;
            border-radius: 50%;
            border: 2px solid var(--light-green);
            opacity: 0;
            animation: pulse 2s infinite;
        }

        .chatbot-window {
            position: absolute;
            bottom: 75px;
            right: 0;
            width: 350px;
            height: 500px;
            background: white;
            border-radius: 20px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.15);
            display: none;
            flex-direction: column;
            overflow: hidden;
            border: 1px solid #e0e0e0;
        }

        .chatbot-header {
            background: linear-gradient(135deg, var(--primary-green), var(--light-green));
            color: white;
            padding: 18px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .chatbot-title {
            display: flex;
            align-items: center;
            gap: 10px;
            font-weight: 600;
            font-size: 1.2rem;
        }

        .chatbot-close {
            background: none;
            border: none;
            color: white;
            font-size: 1.2rem;
            cursor: pointer;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: var(--transition);
        }

        .chatbot-close:hover {
            background: rgba(255, 255, 255, 0.2);
        }

        .chatbot-body {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .chat-message {
            max-width: 85%;
            padding: 12px 16px;
            border-radius: 18px;
            font-size: 0.95rem;
            line-height: 1.4;
        }

        .bot-message {
            background: #f0f7f0;
            align-self: flex-start;
            border-bottom-left-radius: 5px;
            color: var(--text-dark);
        }

        .user-message {
            background: linear-gradient(135deg, var(--light-green), var(--primary-green));
            color: white;
            align-self: flex-end;
            border-bottom-right-radius: 5px;
        }

        .chatbot-input {
            display: flex;
            padding: 15px;
            background: white;
            border-top: 1px solid #e0e0e0;
            gap: 10px;
        }

        .chatbot-input input {
            flex: 1;
            padding: 12px 15px;
            border: 2px solid #e0e0e0;
            border-radius: 25px;
            font-family: 'Poppins', sans-serif;
            font-size: 0.95rem;
            transition: var(--transition);
        }

        .chatbot-input input:focus {
            outline: none;
            border-color: var(--light-green);
            box-shadow: 0 0 0 3px rgba(76, 175, 80, 0.1);
        }

        .chatbot-input button {
            width: 45px;
            height: 45px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--light-green), var(--primary-green));
            color: white;
            border: none;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.1rem;
            transition: var(--transition);
        }

        .chatbot-input button:hover {
            transform: scale(1.1);
        }

        .chatbot-features-list {
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin-top: 15px;
        }

        .feature-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px 15px;
            background: #f9f9f9;
            border-radius: 10px;
            cursor: pointer;
            transition: var(--transition);
            border: 2px solid transparent;
        }

        .feature-item:hover {
            background: #e8f5e9;
            border-color: var(--light-green);
        }

        .feature-number {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            background: var(--primary-green);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            font-size: 0.9rem;
        }

        /* ========== FOOTER ========== */
        footer {
            background-color: var(--dark-green);
            color: white;
            padding: 30px 0;
            margin-top: 50px;
            text-align: center;
        }

        .footer-content {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 20px;
        }

        .footer-logo {
            display: flex;
            align-items: center;
            gap: 10px;
            font-family: 'Roboto Slab', serif;
            font-size: 1.8rem;
        }

        .footer-links {
            display: flex;
            gap: 25px;
            margin-top: 15px;
            flex-wrap: wrap;
            justify-content: center;
        }

        .footer-links a {
            color: white;
            text-decoration: none;
            transition: var(--transition);
        }

        .footer-links a:hover {
            color: var(--wheat);
        }

        .copyright {
            color: rgba(255, 255, 255, 0.7);
            font-size: 0.9rem;
            margin-top: 20px;
        }

        @media (max-width: 1024px) {
            .welcome-card {
                flex-direction: column;
                text-align: center;
            }

            .welcome-image {
                font-size: 4rem;
                margin-top: 20px;
            }
        }

        @media (max-width: 768px) {
            .header-content {
                flex-direction: column;
                gap: 15px;
            }

            .nav-controls {
                width: 100%;
                justify-content: center;
            }

            .chatbot-window {
                width: 300px;
                right: 0;
            }

            .input-form-grid {
                grid-template-columns: 1fr;
            }

            .location-summary {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>

<body>
    <!-- LOGIN PAGE -->
    <div id="loginPage" class="login-page">
        <div class="login-container">
            <div class="login-header">
                <div class="login-logo">
                    <i class="fas fa-seedling"></i>
                    <span>AgroSmart</span>
                </div>

                <div class="login-language-switcher">
                    <button class="login-lang-btn active" data-lang="en" onclick="changeLoginLanguage('en')">EN</button>
                    <button class="login-lang-btn" data-lang="mr" onclick="changeLoginLanguage('mr')"></button>
                    <button class="login-lang-btn" data-lang="hi" onclick="changeLoginLanguage('hi')"></button>
                </div>

                <h1 class="login-title" data-translate="login_welcome">Welcome to AgroSmart</h1>
                <p class="login-subtitle" data-translate="login_subtitle">Please login to access your account</p>
            </div>

            <div class="login-form">
                <div class="error-message" id="loginError">
                    <i class="fas fa-exclamation-circle"></i>
                    <span id="errorText" data-translate="invalid_credentials">Invalid email or password</span>
                </div>

                <div class="input-group">
                    <i class="fas fa-envelope"></i>
                    <input type="email" id="email" class="login-input" placeholder="Email"
                        data-translate-placeholder="email_placeholder">
                </div>

                <div class="input-group">
                    <i class="fas fa-lock"></i>
                    <input type="password" id="password" class="login-input" placeholder="Password"
                        data-translate-placeholder="password_placeholder">
                </div>

                <button class="login-btn" onclick="handleLogin()">
                    <i class="fas fa-sign-in-alt"></i>
                    <span data-translate="btn_login">Login</span>
                </button>
            </div>

            <div class="login-footer">
                <p data-translate="demo_message">This is a demo application. Use any email and password.</p>
                <p style="margin-top: 10px; font-size: 0.9rem;" data-translate="demo_hint">E.g: farmer@agrosmart.com /
                    any password</p>
            </div>
        </div>
    </div>

    <!-- MAIN APP WRAPPER -->
    <div id="mainApp"
        class="main-app bg-background-light dark:bg-background-dark min-h-screen text-slate-900 dark:text-slate-100 font-display">
        <!-- Floating Top Navigation -->
        <nav class="fixed top-6 left-1/2 -translate-x-1/2 w-[92%] max-w-7xl z-50">
            <div
                class="bg-gradient-green rounded-xl px-6 py-3 flex items-center justify-between shadow-glow text-white">
                <div class="flex items-center gap-8">
                    <div class="flex items-center gap-2">
                        <span class="material-symbols-outlined text-3xl">eco</span>
                        <span class="text-xl font-bold tracking-tight">AgroSmart</span>
                    </div>
                    <div class="hidden md:flex items-center gap-6">
                        <a class="text-sm font-medium hover:opacity-80 transition-opacity cursor-pointer"
                            onclick="showPage('dashboard')">Dashboard</a>
                        <a class="text-sm font-medium opacity-70 hover:opacity-100 transition-opacity cursor-pointer"
                            onclick="showPage('about')">My Crops</a>
                        <a class="text-sm font-medium opacity-70 hover:opacity-100 transition-opacity cursor-pointer"
                            onclick="showPage('markets')">Market News</a>
                        <a
                            class="text-sm font-medium opacity-70 hover:opacity-100 transition-opacity cursor-pointer">Support</a>
                    </div>
                </div>
                <div class="flex items-center gap-4">
                    <div
                        class="hidden lg:flex items-center bg-white/20 rounded-lg px-3 py-1.5 w-64 border border-white/10">
                        <span class="material-symbols-outlined text-white/70 text-sm">search</span>
                        <input id="globalSearchInput"
                            class="bg-transparent border-none focus:ring-0 text-xs placeholder:text-white/60 w-full ml-2"
                            placeholder="Search crops, schemes..." type="text" />
                    </div>
                    <button class="p-2 hover:bg-white/10 rounded-full transition-colors relative">
                        <span class="material-symbols-outlined">notifications</span>
                        <span
                            class="absolute top-2 right-2 w-2 h-2 bg-red-400 rounded-full border-2 border-[#2ecc70]"></span>
                    </button>
                    <div class="language-switcher mr-2">
                        <button class="lang-btn active" data-lang="en" onclick="changeLanguage('en')">EN</button>
                        <button class="lang-btn" data-lang="mr" onclick="changeLanguage('mr')"></button>
                        <button class="lang-btn" data-lang="hi" onclick="changeLanguage('hi')"></button>
                    </div>
                    <button class="logout-header-btn" onclick="logout()">
                        <i class="fas fa-sign-out-alt"></i>
                    </button>
                    <div class="h-8 w-8 rounded-full bg-white/20 border border-white/40 overflow-hidden cursor-pointer"
                        onclick="showPage('profile')">
                        <img class="w-full h-full object-cover" data-alt="Profile"
                            src="https://lh3.googleusercontent.com/aida-public/AB6AXuB7bvAnS3Df4iHiAud4dwHplRZ10wya65YZ39Q8YWV5jhb-TWzKXQRPeo1MlXVi6YSM3otcivB50uYEXxlzWYAcT1K85-kQL_mKH7w8utENH--ICBo8_Htc_K3MmiF3FQCpHgmEXKa9gQIP9O9SDRR_AL2h3V6hiwkcxguek5MVNkiHD0HVmk6ED2KSpOklVCOh3-JVLtjg9vG7hJdm2f3UoQnrZgT-8OhMN0_g3bk3Za6zHCUSQ3DJXRQAEdnTzjwGUHbaTKY7Pqk" />
                    </div>
                </div>
            </div>
        </nav>

        <!-- DASHBOARD PAGE -->
        <div class="dashboard-page active pt-32 pb-12" id="dashboardPage">
            <main class="max-w-[1440px] mx-auto">
                <div class="grid grid-cols-12 gap-8">
                    <!-- Left Column: Hero & Features -->
                    <div class="col-span-12 lg:col-span-8 space-y-8">
                        <!-- Hero Welcome Section -->
                        <section
                            class="relative overflow-hidden bg-gradient-green rounded-xl p-8 lg:p-12 shadow-glow text-white flex flex-col md:flex-row items-center justify-between">
                            <div class="z-10 text-center md:text-left">
                                <h1 class="text-4xl lg:text-5xl font-extrabold leading-tight mb-4">Namaste, Rajesh!</h1>
                                <p class="text-lg opacity-90 max-w-md mb-8">Your crops are looking healthy today. You
                                    have 3 new government schemes to review.</p>
                                <button
                                    class="bg-white text-primary px-8 py-3 rounded-lg font-bold text-sm shadow-premium hover:bg-slate-50 transition-colors"
                                    onclick="showPage('governmentSchemes')">
                                    View Schemes
                                </button>
                            </div>
                            <div class="mt-8 md:mt-0 opacity-20 md:opacity-100">
                                <span class="material-symbols-outlined !text-[160px] leading-none">agriculture</span>
                            </div>
                            <!-- Decorative blobs -->
                            <div class="absolute -top-10 -right-10 w-40 h-40 bg-white/10 rounded-full blur-3xl"></div>
                            <div class="absolute -bottom-10 -left-10 w-64 h-64 bg-primary/20 rounded-full blur-3xl">
                            </div>
                        </section>
                        <!-- Feature Grid (4 columns) -->
                        <section>
                            <h2 class="text-xl font-bold mb-6 text-slate-800 dark:text-slate-100">Quick Tools</h2>
                            <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4">
                                <!-- Card 1 -->
                                <div class="bg-white dark:bg-slate-800 p-6 rounded-lg shadow-premium border border-slate-100 dark:border-slate-700 hover:-translate-y-1 transition-transform group cursor-pointer"
                                    onclick="showPage('quickAnalysis')">
                                    <div
                                        class="w-12 h-12 bg-primary/10 rounded-full flex items-center justify-center mb-4 group-hover:bg-primary group-hover:text-white transition-colors text-primary">
                                        <span class="material-symbols-outlined">psychology</span>
                                    </div>
                                    <h3 class="font-bold text-slate-900 dark:text-white mb-1">Crop Advisor</h3>
                                    <p class="text-sm text-slate-500 dark:text-slate-400">AI-driven health checks for
                                        your crops</p>
                                </div>
                                <!-- Card 2 -->
                                <div class="bg-white dark:bg-slate-800 p-6 rounded-lg shadow-premium border border-slate-100 dark:border-slate-700 hover:-translate-y-1 transition-transform group cursor-pointer"
                                    onclick="showPage('governmentSchemes')">
                                    <div
                                        class="w-12 h-12 bg-primary/10 rounded-full flex items-center justify-center mb-4 group-hover:bg-primary group-hover:text-white transition-colors text-primary">
                                        <span class="material-symbols-outlined">account_balance</span>
                                    </div>
                                    <h3 class="font-bold text-slate-900 dark:text-white mb-1">Govt. Schemes</h3>
                                    <p class="text-sm text-slate-500 dark:text-slate-400">Subsidy and grant tracking
                                        systems</p>
                                </div>
                                <!-- Card 3 -->
                                <div class="bg-white dark:bg-slate-800 p-6 rounded-lg shadow-premium border border-slate-100 dark:border-slate-700 hover:-translate-y-1 transition-transform group cursor-pointer"
                                    onclick="showPage('markets')">
                                    <div
                                        class="w-12 h-12 bg-primary/10 rounded-full flex items-center justify-center mb-4 group-hover:bg-primary group-hover:text-white transition-colors text-primary">
                                        <span class="material-symbols-outlined">trending_up</span>
                                    </div>
                                    <h3 class="font-bold text-slate-900 dark:text-white mb-1">Market Prices</h3>
                                    <p class="text-sm text-slate-500 dark:text-slate-400">Live mandi rates from nearby
                                        cities</p>
                                </div>
                                <!-- Card 4 -->
                                <div class="bg-white dark:bg-slate-800 p-6 rounded-lg shadow-premium border border-slate-100 dark:border-slate-700 hover:-translate-y-1 transition-transform group cursor-pointer"
                                    onclick="showPage('calculator')">
                                    <div
                                        class="w-12 h-12 bg-primary/10 rounded-full flex items-center justify-center mb-4 group-hover:bg-primary group-hover:text-white transition-colors text-primary">
                                        <span class="material-symbols-outlined">calculate</span>
                                    </div>
                                    <h3 class="font-bold text-slate-900 dark:text-white mb-1">Profit Calc</h3>
                                    <p class="text-sm text-slate-500 dark:text-slate-400">Financial forecasting & yield
                                        tools</p>
                                </div>
                            </div>
                        </section>
                        <!-- Statistics Section -->
                        <section>
                            <h2 class="text-xl font-bold mb-6 text-slate-800 dark:text-slate-100">Coverage Overview</h2>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <div
                                    class="bg-white dark:bg-slate-800 p-8 rounded-lg shadow-premium border border-slate-100 dark:border-slate-700 flex items-center gap-6">
                                    <div class="text-6xl font-black text-primary" id="statesCount">04</div>
                                    <div>
                                        <h3 class="text-lg font-bold text-slate-900 dark:text-white"
                                            data-translate="stats_states">States Covered</h3>
                                        <p class="text-slate-500 dark:text-slate-400">Maharashtra Region</p>
                                    </div>
                                </div>
                                <div
                                    class="bg-white dark:bg-slate-800 p-8 rounded-lg shadow-premium border border-slate-100 dark:border-slate-700 flex items-center gap-6">
                                    <div class="text-6xl font-black text-primary" id="districtsCount">15</div>
                                    <div>
                                        <h3 class="text-lg font-bold text-slate-900 dark:text-white"
                                            data-translate="stats_districts">Districts Analyzed</h3>
                                        <p class="text-slate-500 dark:text-slate-400">Real-time data feeds active</p>
                                    </div>
                                </div>
                            </div>
                        </section>
                    </div>
                    <!-- Right Column: Quick Insights -->
                    <div class="col-span-12 lg:col-span-4 space-y-8">
                        <section>
                            <h2 class="text-xl font-bold mb-6 text-slate-800 dark:text-slate-100">Quick Insights</h2>
                            <div class="space-y-4">
                                <!-- Insight Card 1 -->
                                <div
                                    class="bg-white dark:bg-slate-800 p-6 rounded-lg shadow-premium border-l-4 border-l-primary border-y border-r border-slate-100 dark:border-slate-700 relative overflow-hidden">
                                    <div class="flex items-start gap-4">
                                        <span class="material-symbols-outlined text-amber-500">cloud</span>
                                        <div>
                                            <h4 class="font-bold text-slate-900 dark:text-white">Weather Alert</h4>
                                            <p class="text-sm text-slate-600 dark:text-slate-400 mt-1">Heavy rain
                                                expected in 2 days. Secure your harvest soon.</p>
                                            <span
                                                class="text-[10px] font-bold uppercase tracking-wider text-slate-400 mt-2 block">2
                                                hours ago</span>
                                        </div>
                                    </div>
                                </div>
                                <!-- Insight Card 2 -->
                                <div
                                    class="bg-white dark:bg-slate-800 p-6 rounded-lg shadow-premium border-l-4 border-l-primary border-y border-r border-slate-100 dark:border-slate-700">
                                    <div class="flex items-start gap-4">
                                        <span class="material-symbols-outlined text-primary">science</span>
                                        <div>
                                            <h4 class="font-bold text-slate-900 dark:text-white">Soil Health Update</h4>
                                            <p class="text-sm text-slate-600 dark:text-slate-400 mt-1">Nitrogen levels
                                                in North Plot are optimal for the next cycle.</p>
                                            <span
                                                class="text-[10px] font-bold uppercase tracking-wider text-slate-400 mt-2 block">5
                                                hours ago</span>
                                        </div>
                                    </div>
                                </div>
                                <!-- Insight Card 3 -->
                                <div
                                    class="bg-white dark:bg-slate-800 p-6 rounded-lg shadow-premium border-l-4 border-l-primary border-y border-r border-slate-100 dark:border-slate-700">
                                    <div class="flex items-start gap-4">
                                        <span class="material-symbols-outlined text-primary">monitoring</span>
                                        <div>
                                            <h4 class="font-bold text-slate-900 dark:text-white">Market Trend</h4>
                                            <p class="text-sm text-slate-600 dark:text-slate-400 mt-1">Wheat prices are
                                                up 5% in the local mandi today.</p>
                                            <span
                                                class="text-[10px] font-bold uppercase tracking-wider text-slate-400 mt-2 block">12
                                                hours ago</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </section>
                        <!-- Mini Map / Area Info -->
                        <section
                            class="bg-white dark:bg-slate-800 rounded-lg shadow-premium border border-slate-100 dark:border-slate-700 overflow-hidden">
                            <div
                                class="p-4 border-b border-slate-100 dark:border-slate-700 flex justify-between items-center">
                                <span class="font-bold text-slate-800 dark:text-white">Farm Location</span>
                                <span class="text-xs text-primary font-medium flex items-center gap-1">
                                    <span class="material-symbols-outlined text-sm">location_on</span> Satara, MH
                                </span>
                            </div>
                            <div class="h-48 bg-slate-200 relative">
                                <img class="w-full h-full object-cover grayscale-[20%]"
                                    data-alt="Satellite view of farming land in Satara" data-location="Satara"
                                    src="https://lh3.googleusercontent.com/aida-public/AB6AXuAfJ5GJqgwrPO70ByxHnXsACwYxk3LXErggiviml24KB3FuQodKk75aDRHfYMJCheFgZK1d0-csQARex19KY1Xjxu3vgp7AyPcMKtB7PzfHlMOzmDkq7Pof7JtwPOWPlJutPw0YYy_WQ48RvBjgioP6mJiNvNocxqWTYT34417jJTS4wgJiP65DdKsu7npwfsYeQvU1XepWkTTf5YkxrcyZnFsycoVI4D1yPmP2apEw-emf5kEjtcSpra967-aVkd4WTBpGwHRixRQ" />
                                <div class="absolute inset-0 flex items-center justify-center">
                                    <div
                                        class="w-8 h-8 bg-primary rounded-full border-4 border-white shadow-lg animate-pulse">
                                    </div>
                                </div>
                            </div>
                        </section>
                    </div>
                </div>
            </main>
            <!-- Footer Status Bar -->
            <footer
                class="fixed bottom-0 left-0 right-0 bg-white/80 dark:bg-slate-900/80 glass-effect border-t border-slate-100 dark:border-slate-800 px-6 py-2 z-40">
                <div
                    class="max-w-[1440px] mx-auto flex justify-between items-center text-[10px] font-bold uppercase tracking-widest text-slate-400 dark:text-slate-500">
                    <div class="flex items-center gap-4">
                        <span class="flex items-center gap-1.5"><span
                                class="w-1.5 h-1.5 rounded-full bg-primary"></span> System Online</span>
                        <span class="opacity-50">v4.2.0-stable</span>
                    </div>
                    <div class="flex items-center gap-2">
                        <span class="material-symbols-outlined text-sm">sync</span>
                        Last Synced: Today at 08:45 AM
                    </div>
                </div>
            </footer>
        </div>

        <!-- QUICK ANALYSIS PAGE (Now only Maharashtra districts) -->
        <div class="dashboard-page pt-32 pb-12" id="quickAnalysisPage">
            <button class="back-btn" onclick="showPage('dashboard')">
                <i class="fas fa-arrow-left"></i> <span data-translate="btn_back_dashboard">Back to Dashboard</span>
            </button>

            <div class="quick-analysis-container">
                <h2 data-translate="quick_analysis_title">Maharashtra District Analysis</h2>
                <p data-translate="quick_analysis_desc">Select a district to get personalized crop recommendations
                </p>

                <div class="quick-analysis-form">
                    <div class="form-group">
                        <label class="form-label" data-translate="label_district">Select District</label>
                        <div class="searchable-select-container" id="districtSearchContainer">
                            <input type="text" class="searchable-select-input" id="districtSearchInput"
                                placeholder="Type to filter districts..." data-translate-placeholder="type_to_filter">
                            <div class="searchable-dropdown" id="districtDropdown"></div>
                            <select id="quickDistrictSelect" style="display: none;">
                                <option value="">-- Select District --</option>
                                <option value="akola">Akola</option>
                                <option value="ahmednagar">Ahmednagar</option>
                                <option value="amravati">Amravati</option>
                                <option value="aurangabad">Aurangabad</option>
                                <option value="buldhana">Buldhana</option>
                                <option value="nashik">Nashik</option>
                                <option value="nagpur">Nagpur</option>
                                <option value="pune">Pune</option>
                                <option value="kolhapur">Kolhapur</option>
                                <option value="sangli">Sangli</option>
                                <option value="satara">Satara</option>
                                <option value="solapur">Solapur</option>
                                <option value="jalgaon">Jalgaon</option>
                                <option value="dhule">Dhule</option>
                                <option value="nanded">Nanded</option>
                                <option value="latur">Latur</option>
                                <option value="osmanabad">Osmanabad</option>
                                <option value="beed">Beed</option>
                                <option value="wardha">Wardha</option>
                                <option value="yavatmal">Yavatmal</option>
                            </select>
                        </div>
                    </div>

                    <button class="btn btn-primary" onclick="viewQuickDistrict()" id="viewDetailsBtn">
                        <i class="fas fa-eye"></i> <span data-translate="btn_view_details">Get
                            Recommendations</span>
                    </button>
                </div>
            </div>
        </div>

        <!-- DISTRICT DETAILS PAGE - Now with Crop Recommendation -->
        <div class="dashboard-page pt-32 pb-12" id="districtDetailsPage">
            <button class="back-btn" onclick="showPage('quickAnalysis')">
                <i class="fas fa-arrow-left"></i> <span data-translate="btn_back">Back to Districts</span>
            </button>

            <div class="district-details">
                <div class="details-header">
                    <h2 class="district-title" id="districtDetailsTitle">Maharashtra - District Information</h2>
                </div>

                <!-- NEW INPUT FORM SECTION (Replaces old table) -->
                <div class="input-form-section">
                    <h3><i class="fas fa-clipboard-list"></i> Enter Your Farm Details</h3>
                    <div class="input-form-grid">
                        <div class="form-group">
                            <label class="form-label">Village <span
                                    style="color: var(--text-light); font-size: 0.85rem;">(Type to
                                    search)</span></label>
                            <div class="searchable-select-container" id="villageSearchContainer">
                                <input type="text" class="searchable-select-input" id="villageSearchInput"
                                    placeholder="Type village name..." disabled>
                                <div class="searchable-dropdown" id="villageDropdown"></div>
                                <select id="villageSelect" style="display: none;">
                                    <option value="">-- Select Village --</option>
                                </select>
                            </div>
                        </div>

                        <div class="form-group">
                            <label class="form-label">Land Size (acres)</label>
                            <input type="number" class="form-input" id="landSize" min="0.1" step="0.1" value="5">
                        </div>

                        <div class="form-group">
                            <label class="form-label">Water Source</label>
                            <div class="searchable-select-container" id="waterSourceContainer">
                                <input type="text" class="searchable-select-input" id="waterSourceInput"
                                    placeholder="Type to filter...">
                                <div class="searchable-dropdown" id="waterSourceDropdown"></div>
                                <select id="waterSource" style="display: none;">
                                    <option value="Well">Well</option>
                                    <option value="Borewell">Borewell</option>
                                    <option value="Canal">Canal</option>
                                    <option value="Farm Pond">Farm Pond</option>
                                    <option value="River">River</option>
                                </select>
                            </div>
                        </div>

                        <div class="form-group">
                            <label class="form-label">Water Level</label>
                            <div class="searchable-select-container" id="waterLevelContainer">
                                <input type="text" class="searchable-select-input" id="waterLevelInput"
                                    placeholder="Type to filter...">
                                <div class="searchable-dropdown" id="waterLevelDropdown"></div>
                                <select id="waterLevel" style="display: none;">
                                    <option value="Low">Low</option>
                                    <option value="Medium">Medium</option>
                                    <option value="High">High</option>
                                </select>
                            </div>
                        </div>

                        <div class="form-group">
                            <label class="form-label">Budget Level</label>
                            <div class="searchable-select-container" id="budgetContainer">
                                <input type="text" class="searchable-select-input" id="budgetInput"
                                    placeholder="Type to filter...">
                                <div class="searchable-dropdown" id="budgetDropdown"></div>
                                <select id="budgetLevel" style="display: none;">
                                    <option value="Low">Low Investment</option>
                                    <option value="Medium">Medium Investment</option>
                                    <option value="High">High Investment</option>
                                </select>
                            </div>
                        </div>

                        <div class="form-group">
                            <label class="form-label">Soil Type</label>
                            <div class="searchable-select-container" id="soilContainer">
                                <input type="text" class="searchable-select-input" id="soilInput"
                                    placeholder="Type to filter...">
                                <div class="searchable-dropdown" id="soilDropdown"></div>
                                <select id="soilType" style="display: none;">
                                    <option value="Black">Black Soil</option>
                                    <option value="Red">Red Soil</option>
                                    <option value="Sandy Loam">Sandy Loam</option>
                                    <option value="Laterite">Laterite Soil</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <div class="calculator-actions">
                        <button class="btn btn-generate" onclick="generateCropRecommendation()">
                            <i class="fas fa-chart-line"></i> Generate Crop Recommendation
                        </button>
                        <button class="btn btn-secondary" onclick="resetRecommendationForm()">
                            <i class="fas fa-redo"></i> Reset
                        </button>
                    </div>
                </div>

                <!-- RECOMMENDATION REPORT SECTION (Initially hidden) -->
                <div id="recommendationReport" class="recommendation-report" style="display: none;">
                    <!-- Content will be filled by JavaScript -->
                </div>

                <!-- Map and YouTube (UNCHANGED) -->
                <div class="dashboard-grid">
                    <div class="dashboard-card">
                        <div class="card-header">
                            <h3 class="card-title" data-translate="district_map">District Map</h3>
                            <div class="card-icon"><i class="fas fa-map"></i></div>
                        </div>
                        <div id="districtMapContainer"></div>
                    </div>

                    <div class="dashboard-card">
                        <div class="card-header">
                            <h3 class="card-title" data-translate="youtube_resources">YouTube Resources</h3>
                            <div class="card-icon"><i class="fab fa-youtube"></i></div>
                        </div>
                        <div id="youtubeVideosContainer"></div>
                    </div>
                </div>

                <!-- Agricultural Recommendations (UNCHANGED) -->
                <div class="dashboard-card" style="margin-top: 30px;">
                    <div class="card-header">
                        <h3 class="card-title" data-translate="recommendations_title">Agricultural Recommendations
                        </h3>
                        <div class="card-icon"><i class="fas fa-lightbulb"></i></div>
                    </div>
                    <p id="districtRecommendations" style="color: var(--text-light);"></p>
                </div>
            </div>

            <!-- PROFIT CALCULATOR with ALL THREE TABS (UNCHANGED) -->
            <div class="profit-calculator" id="profitCalculator">
                <div class="calculator-header">
                    <i class="fas fa-calculator"></i>
                    <div>
                        <h2 class="calculator-title" id="calculatorTitle" data-translate="calculator_title">
                            Agricultural Profit Calculator</h2>
                        <p class="calculator-subtitle" id="calculatorSubtitle" data-translate="calculator_subtitle">
                            Calculate expected profits for crops in this district</p>
                    </div>
                </div>

                <div class="calculator-tabs">
                    <button class="tab-btn active" data-tab="basic" data-translate="tab_basic">Basic
                        Calculator</button>
                    <button class="tab-btn" data-tab="advanced" data-translate="tab_advanced">Advanced
                        Calculator</button>
                    <button class="tab-btn" data-tab="compare" data-translate="tab_compare">Compare Crops</button>
                </div>

                <!-- BASIC CALCULATOR TAB -->
                <div class="tab-content active" id="basicTab">
                    <div class="calculator-form">
                        <div class="form-group">
                            <label class="form-label" for="cropSelect">
                                <span data-translate="label_crop">Select Crop</span>
                                <span data-translate="label_crop_desc">Choose from recommended crops</span>
                            </label>
                            <select class="form-select" id="cropSelect"></select>
                        </div>
                        <div class="form-group">
                            <label class="form-label" for="areaInput">
                                <span data-translate="label_area">Cultivation Area</span>
                                <span data-translate="label_area_desc">In acres</span>
                            </label>
                            <input type="number" class="form-input" id="areaInput" min="0.1" step="0.1" value="1">
                        </div>
                        <div class="form-group">
                            <label class="form-label" for="yieldInput">
                                <span data-translate="label_yield">Expected Yield</span>
                                <span data-translate="label_yield_desc">Quintal per acre</span>
                            </label>
                            <input type="number" class="form-input" id="yieldInput" min="1" step="0.1" value="8">
                        </div>
                        <div class="form-group">
                            <label class="form-label" for="priceInput">
                                <span data-translate="label_price">Expected Price</span>
                                <span data-translate="label_price_desc"> per quintal</span>
                            </label>
                            <input type="number" class="form-input" id="priceInput" min="100" step="50" value="6500">
                        </div>
                    </div>

                    <div class="calculator-actions">
                        <button class="btn btn-calculate" id="calculateBtn">
                            <i class="fas fa-calculator"></i> <span data-translate="btn_calculate">Calculate
                                Profit</span>
                        </button>
                        <button class="btn btn-secondary" id="resetBtn">
                            <i class="fas fa-redo"></i> <span data-translate="btn_reset">Reset</span>
                        </button>
                    </div>

                    <div class="calculator-results" id="resultsSection" style="display: none;">
                        <div class="results-header">
                            <h3 class="results-title" data-translate="results_title">Profit Calculation Results</h3>
                            <div class="profit-badge profit-positive" id="profitBadge" data-translate="profit">
                                PROFIT</div>
                        </div>
                        <div class="results-grid" id="resultsGrid"></div>
                    </div>
                </div>

                <!-- ADVANCED CALCULATOR TAB -->
                <div class="tab-content" id="advancedTab">
                    <p style="color: var(--text-light); margin-bottom: 20px;" data-translate="advanced_desc">
                        Detailed expense calculator with custom inputs for accurate profit estimation.</p>
                    <div class="calculator-form">
                        <!-- Advanced calculator fields - kept for compatibility -->
                        <div class="form-group">
                            <label class="form-label" for="advancedCropSelect">
                                <span data-translate="label_crop">Select Crop</span>
                                <span data-translate="label_crop_desc">Choose from district's top crops</span>
                            </label>
                            <select class="form-select" id="advancedCropSelect"></select>
                        </div>
                        <div class="form-group">
                            <label class="form-label" for="advancedAreaInput">
                                <span data-translate="label_area">Cultivation Area</span>
                                <span data-translate="label_area_desc">In acres</span>
                            </label>
                            <input type="number" class="form-input" id="advancedAreaInput" min="0.1" step="0.1"
                                value="1">
                        </div>
                        <div class="form-group">
                            <label class="form-label" for="advancedYieldInput">
                                <span data-translate="label_yield">Expected Yield</span>
                                <span data-translate="label_yield_desc">Quintal per acre</span>
                            </label>
                            <input type="number" class="form-input" id="advancedYieldInput" min="1" step="0.1"
                                value="8">
                        </div>
                        <div class="form-group">
                            <label class="form-label" for="advancedPriceInput">
                                <span data-translate="label_price">Expected Price</span>
                                <span data-translate="label_price_desc"> per quintal</span>
                            </label>
                            <input type="number" class="form-input" id="advancedPriceInput" min="100" step="50"
                                value="6500">
                        </div>
                        <div class="form-group">
                            <label class="form-label" for="seedsCost">
                                <span data-translate="label_seeds">Seeds Cost</span>
                                <span data-translate="label_seeds_desc"> per acre</span>
                            </label>
                            <input type="number" class="form-input" id="seedsCost" min="0" step="100" value="2000">
                        </div>
                        <div class="form-group">
                            <label class="form-label" for="fertilizerCost">
                                <span data-translate="label_fertilizer">Fertilizers Cost</span>
                                <span data-translate="label_fertilizer_desc"> per acre</span>
                            </label>
                            <input type="number" class="form-input" id="fertilizerCost" min="0" step="100" value="4500">
                        </div>
                        <div class="form-group">
                            <label class="form-label" for="pesticideCost">
                                <span data-translate="label_pesticide">Pesticides Cost</span>
                                <span data-translate="label_pesticide_desc"> per acre</span>
                            </label>
                            <input type="number" class="form-input" id="pesticideCost" min="0" step="100" value="3000">
                        </div>
                        <div class="form-group">
                            <label class="form-label" for="irrigationCost">
                                <span data-translate="label_irrigation">Irrigation Cost</span>
                                <span data-translate="label_irrigation_desc"> per acre</span>
                            </label>
                            <input type="number" class="form-input" id="irrigationCost" min="0" step="100" value="2500">
                        </div>
                        <div class="form-group">
                            <label class="form-label" for="laborCost">
                                <span data-translate="label_labor">Labor Cost</span>
                                <span data-translate="label_labor_desc"> per acre</span>
                            </label>
                            <input type="number" class="form-input" id="laborCost" min="0" step="100" value="8000">
                        </div>
                        <div class="form-group">
                            <label class="form-label" for="otherCost">
                                <span data-translate="label_other">Other Costs</span>
                                <span data-translate="label_other_desc"> per acre</span>
                            </label>
                            <input type="number" class="form-input" id="otherCost" min="0" step="100" value="2000">
                        </div>
                    </div>

                    <div class="calculator-actions">
                        <button class="btn btn-calculate" id="advancedCalculateBtn">
                            <i class="fas fa-calculator"></i> <span data-translate="btn_calculate_detailed">Calculate
                                Detailed Profit</span>
                        </button>
                        <button class="btn btn-secondary" id="advancedResetBtn">
                            <i class="fas fa-redo"></i> <span data-translate="btn_reset">Reset</span>
                        </button>
                    </div>

                    <div class="calculator-results" id="advancedResultsSection" style="display: none;">
                        <div class="results-header">
                            <h3 class="results-title" data-translate="results_detailed">Detailed Profit Calculation
                            </h3>
                            <div class="profit-badge profit-positive" id="advancedProfitBadge" data-translate="profit">
                                PROFIT</div>
                        </div>
                        <div class="results-grid" id="advancedResultsGrid"></div>
                    </div>
                </div>

                <!-- COMPARE CROPS TAB -->
                <div class="tab-content" id="compareTab">
                    <p style="color: var(--text-light); margin-bottom: 20px;" data-translate="compare_desc">Compare
                        profitability of different crops in this district.</p>
                    <div class="compare-crops-section">
                        <div class="crop-comparison-controls">
                            <select class="form-select" id="crop1Select" style="flex: 1;">
                                <option value="" data-translate="select_crop1">Select Crop 1</option>
                            </select>
                            <select class="form-select" id="crop2Select" style="flex: 1;">
                                <option value="" data-translate="select_crop2">Select Crop 2</option>
                            </select>
                            <button class="btn btn-primary" id="compareCropsBtn">
                                <i class="fas fa-balance-scale"></i> <span data-translate="btn_compare_crops">Compare
                                    Crops</span>
                            </button>
                        </div>
                        <div id="cropComparisonResults" style="display: none;"></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- GOVERNMENT SCHEMES PAGE (UNCHANGED) -->
        <div class="dashboard-page pt-32 pb-12" id="governmentSchemesPage">
            <button class="back-btn" onclick="showPage('dashboard')">
                <i class="fas fa-arrow-left"></i> <span data-translate="btn_back_dashboard">Back to Dashboard</span>
            </button>

            <h1 class="page-title">
                <i class="fas fa-landmark"></i>
                <span data-translate="schemes_title">Government Schemes for Farmers</span>
            </h1>
            <p class="page-description" data-translate="schemes_desc">Explore various government schemes, subsidies,
                and support programs available for Indian farmers</p>

            <div class="search-container">
                <div class="search-box">
                    <i class="fas fa-search search-icon"></i>
                    <input type="text" class="search-input" id="schemeSearchInput"
                        placeholder="Search for schemes (e.g. PM-KISAN, Crop Insurance...)"
                        data-translate-placeholder="search_scheme_placeholder">
                    <button class="search-clear" id="clearSchemeSearch" style="display: none;">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                <div class="search-info">
                    <span id="schemeSearchCount" data-translate="showing_schemes">Showing 5 schemes</span>
                    <span data-translate="search_type">Type to filter</span>
                </div>
            </div>

            <div class="schemes-grid" id="schemesGrid"></div>
        </div>

        <!-- MARKETS PAGE (UNCHANGED) -->
        <div class="dashboard-page pt-32 pb-12" id="marketsPage">
            <button class="back-btn" onclick="showPage('dashboard')">
                <i class="fas fa-arrow-left"></i> <span data-translate="btn_back_dashboard">Back to Dashboard</span>
            </button>

            <h1 class="page-title">
                <i class="fas fa-chart-line"></i>
                <span data-translate="markets_title">Market Price Comparison</span>
            </h1>
            <p class="page-description" data-translate="markets_desc">Compare crop prices across different markets
                and find the best price.</p>

            <div class="district-details">
                <div class="calculator-header">
                    <i class="fas fa-filter"></i>
                    <div>
                        <h2 class="calculator-title" data-translate="markets_filter">Market Filter</h2>
                        <p class="calculator-subtitle" data-translate="markets_filter_desc">Select crop and state to
                            view market prices</p>
                    </div>
                </div>

                <div class="calculator-form">
                    <div class="form-group">
                        <label class="form-label" for="marketCropSelect">
                            <span data-translate="label_crop">Select Crop</span>
                        </label>
                        <select class="form-select" id="marketCropSelect">
                            <option value="Cotton" data-translate="crop_cotton">Cotton</option>
                            <option value="Soybean" data-translate="crop_soybean">Soybean</option>
                            <option value="Sugarcane" data-translate="crop_sugarcane">Sugarcane</option>
                            <option value="Wheat" data-translate="crop_wheat">Wheat</option>
                            <option value="Rice" data-translate="crop_rice">Rice</option>
                            <option value="Onion" data-translate="crop_onion">Onion</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label class="form-label" for="marketStateSelect">
                            <span data-translate="label_state">Select State</span>
                        </label>
                        <select class="form-select" id="marketStateSelect">
                            <option value="all" data-translate="all_states">All States</option>
                            <option value="maharashtra" data-translate="state_maharashtra">Maharashtra</option>
                            <option value="gujarat" data-translate="state_gujarat">Gujarat</option>
                            <option value="punjab" data-translate="state_punjab">Punjab</option>
                            <option value="karnataka" data-translate="state_karnataka">Karnataka</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label class="form-label" for="marketDate">
                            <span data-translate="market_date">Date</span>
                        </label>
                        <input type="date" class="form-input" id="marketDate" value="2024-03-15">
                    </div>
                </div>

                <div class="calculator-actions">
                    <button class="btn btn-primary" id="searchMarketsBtn" onclick="searchMarkets()">
                        <i class="fas fa-search"></i> <span data-translate="btn_search_markets">Search
                            Markets</span>
                    </button>
                    <button class="btn btn-secondary" id="resetMarketsBtn" onclick="resetMarkets()">
                        <i class="fas fa-redo"></i> <span data-translate="btn_reset">Reset</span>
                    </button>
                </div>

                <div id="marketsResults" style="margin-top: 30px; display: none;">
                    <h3 style="color: var(--dark-green); margin-bottom: 20px;" data-translate="markets_results">
                        Market Price Results</h3>
                    <div style="overflow-x: auto;">
                        <table class="market-table" id="marketsTable">
                            <thead>
                                <tr>
                                    <th data-translate="market_name">Market</th>
                                    <th data-translate="crop">Crop</th>
                                    <th data-translate="state">State</th>
                                    <th data-translate="price">Price (/quintal)</th>
                                    <th data-translate="change">Change</th>
                                    <th data-translate="date">Date</th>
                                </tr>
                            </thead>
                            <tbody id="marketsTableBody"></tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>

        <!-- CALCULATOR PAGE (UNCHANGED) -->
        <div class="dashboard-page pt-32 pb-12" id="calculatorPage">
            <button class="back-btn" onclick="showPage('dashboard')">
                <i class="fas fa-arrow-left"></i> <span data-translate="btn_back_dashboard">Back to Dashboard</span>
            </button>

            <h1 class="page-title">
                <i class="fas fa-calculator"></i>
                <span data-translate="calculator_page_title">Profit Calculator</span>
            </h1>
            <p class="page-description" data-translate="calculator_page_desc">Calculate profit and expenses for your
                crops. Use basic or advanced calculator.</p>

            <div class="calculator-page">
                <div class="calculator-tabs-container">
                    <button class="tab-btn active" data-tab="basicCalculator" data-translate="tab_basic">Basic
                        Calculator</button>
                    <button class="tab-btn" data-tab="advancedCalculator" data-translate="tab_advanced">Advanced
                        Calculator</button>
                </div>

                <div class="tab-content active" id="basicCalculator">
                    <div class="calculator-form">
                        <div class="form-group">
                            <label class="form-label" for="generalCropSelect">
                                <span data-translate="label_crop">Select Crop</span>
                            </label>
                            <select class="form-select" id="generalCropSelect">
                                <option value="Cotton" data-translate="crop_cotton">Cotton</option>
                                <option value="Soybean" data-translate="crop_soybean">Soybean</option>
                                <option value="Sugarcane" data-translate="crop_sugarcane">Sugarcane</option>
                                <option value="Wheat" data-translate="crop_wheat">Wheat</option>
                                <option value="Rice" data-translate="crop_rice">Rice</option>
                                <option value="Onion" data-translate="crop_onion">Onion</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label" for="generalAreaInput">
                                <span data-translate="label_area">Cultivation Area</span>
                                <span data-translate="label_area_desc">In acres</span>
                            </label>
                            <input type="number" class="form-input" id="generalAreaInput" min="0.1" step="0.1"
                                value="1">
                        </div>
                        <div class="form-group">
                            <label class="form-label" for="generalYieldInput">
                                <span data-translate="label_yield">Expected Yield</span>
                                <span data-translate="label_yield_desc">Quintal per acre</span>
                            </label>
                            <input type="number" class="form-input" id="generalYieldInput" min="1" step="0.1"
                                value="10">
                        </div>
                        <div class="form-group">
                            <label class="form-label" for="generalPriceInput">
                                <span data-translate="label_price">Expected Price</span>
                                <span data-translate="label_price_desc"> per quintal</span>
                            </label>
                            <input type="number" class="form-input" id="generalPriceInput" min="100" step="50"
                                value="5000">
                        </div>
                    </div>

                    <div class="calculator-actions">
                        <button class="btn btn-calculate" id="generalCalculateBtn">
                            <i class="fas fa-calculator"></i> <span data-translate="btn_calculate">Calculate
                                Profit</span>
                        </button>
                        <button class="btn btn-secondary" id="generalResetBtn">
                            <i class="fas fa-redo"></i> <span data-translate="btn_reset">Reset</span>
                        </button>
                    </div>

                    <div class="calculator-results" id="generalResultsSection" style="display: none;">
                        <div class="results-header">
                            <h3 class="results-title" data-translate="results_title">Profit Calculation Results</h3>
                            <div class="profit-badge profit-positive" id="generalProfitBadge" data-translate="profit">
                                PROFIT</div>
                        </div>
                        <div class="results-grid" id="generalResultsGrid"></div>
                    </div>
                </div>

                <div class="tab-content" id="advancedCalculator">
                    <p style="color: var(--text-light); margin-bottom: 20px;" data-translate="advanced_desc">
                        Detailed expense calculator with custom inputs for accurate profit estimation.</p>
                    <div class="calculator-form">
                        <!-- Advanced calculator fields - kept for compatibility -->
                        <div class="form-group">
                            <label class="form-label" for="advancedGeneralCropSelect">
                                <span data-translate="label_crop">Select Crop</span>
                            </label>
                            <select class="form-select" id="advancedGeneralCropSelect">
                                <option value="Cotton" data-translate="crop_cotton">Cotton</option>
                                <option value="Soybean" data-translate="crop_soybean">Soybean</option>
                                <option value="Sugarcane" data-translate="crop_sugarcane">Sugarcane</option>
                                <option value="Wheat" data-translate="crop_wheat">Wheat</option>
                                <option value="Rice" data-translate="crop_rice">Rice</option>
                                <option value="Onion" data-translate="crop_onion">Onion</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label" for="advancedGeneralAreaInput">
                                <span data-translate="label_area">Cultivation Area</span>
                                <span data-translate="label_area_desc">In acres</span>
                            </label>
                            <input type="number" class="form-input" id="advancedGeneralAreaInput" min="0.1" step="0.1"
                                value="1">
                        </div>
                        <div class="form-group">
                            <label class="form-label" for="advancedGeneralYieldInput">
                                <span data-translate="label_yield">Expected Yield</span>
                                <span data-translate="label_yield_desc">Quintal per acre</span>
                            </label>
                            <input type="number" class="form-input" id="advancedGeneralYieldInput" min="1" step="0.1"
                                value="10">
                        </div>
                        <div class="form-group">
                            <label class="form-label" for="advancedGeneralPriceInput">
                                <span data-translate="label_price">Expected Price</span>
                                <span data-translate="label_price_desc"> per quintal</span>
                            </label>
                            <input type="number" class="form-input" id="advancedGeneralPriceInput" min="100" step="50"
                                value="5000">
                        </div>
                        <div class="form-group">
                            <label class="form-label" for="advancedGeneralSeedsCost">
                                <span data-translate="label_seeds">Seeds Cost</span>
                                <span data-translate="label_seeds_desc"> per acre</span>
                            </label>
                            <input type="number" class="form-input" id="advancedGeneralSeedsCost" min="0" step="100"
                                value="2000">
                        </div>
                        <div class="form-group">
                            <label class="form-label" for="advancedGeneralFertilizerCost">
                                <span data-translate="label_fertilizer">Fertilizers Cost</span>
                                <span data-translate="label_fertilizer_desc"> per acre</span>
                            </label>
                            <input type="number" class="form-input" id="advancedGeneralFertilizerCost" min="0"
                                step="100" value="3500">
                        </div>
                        <div class="form-group">
                            <label class="form-label" for="advancedGeneralPesticideCost">
                                <span data-translate="label_pesticide">Pesticides Cost</span>
                                <span data-translate="label_pesticide_desc"> per acre</span>
                            </label>
                            <input type="number" class="form-input" id="advancedGeneralPesticideCost" min="0" step="100"
                                value="2500">
                        </div>
                        <div class="form-group">
                            <label class="form-label" for="advancedGeneralIrrigationCost">
                                <span data-translate="label_irrigation">Irrigation Cost</span>
                                <span data-translate="label_irrigation_desc"> per acre</span>
                            </label>
                            <input type="number" class="form-input" id="advancedGeneralIrrigationCost" min="0"
                                step="100" value="2000">
                        </div>
                        <div class="form-group">
                            <label class="form-label" for="advancedGeneralLaborCost">
                                <span data-translate="label_labor">Labor Cost</span>
                                <span data-translate="label_labor_desc"> per acre</span>
                            </label>
                            <input type="number" class="form-input" id="advancedGeneralLaborCost" min="0" step="100"
                                value="6000">
                        </div>
                        <div class="form-group">
                            <label class="form-label" for="advancedGeneralOtherCost">
                                <span data-translate="label_other">Other Costs</span>
                                <span data-translate="label_other_desc"> per acre</span>
                            </label>
                            <input type="number" class="form-input" id="advancedGeneralOtherCost" min="0" step="100"
                                value="1500">
                        </div>
                    </div>

                    <div class="calculator-actions">
                        <button class="btn btn-calculate" id="advancedGeneralCalculateBtn">
                            <i class="fas fa-calculator"></i> <span data-translate="btn_calculate_detailed">Calculate
                                Detailed Profit</span>
                        </button>
                        <button class="btn btn-secondary" id="advancedGeneralResetBtn">
                            <i class="fas fa-redo"></i> <span data-translate="btn_reset">Reset</span>
                        </button>
                    </div>

                    <div class="calculator-results" id="advancedGeneralResultsSection" style="display: none;">
                        <div class="results-header">
                            <h3 class="results-title" data-translate="results_detailed">Detailed Profit Calculation
                            </h3>
                            <div class="profit-badge profit-positive" id="advancedGeneralProfitBadge"
                                data-translate="profit">PROFIT</div>
                        </div>
                        <div class="results-grid" id="advancedGeneralResultsGrid"></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- ABOUT PAGE (UNCHANGED) -->
        <div class="dashboard-page pt-32 pb-12" id="aboutPage">
            <button class="back-btn" onclick="showPage('dashboard')">
                <i class="fas fa-arrow-left"></i> <span data-translate="btn_back_dashboard">Back to Dashboard</span>
            </button>

            <h1 class="page-title">
                <i class="fas fa-info-circle"></i>
                <span data-translate="about_title">About AgroSmart</span>
            </h1>

            <div class="district-details">
                <h3 data-translate="about_mission">Our Mission</h3>
                <p style="color: var(--text-light); margin-bottom: 20px;" data-translate="about_mission_desc">
                    AgroSmart aims to empower Indian farmers with data-driven agricultural insights, helping them
                    make informed decisions about crops, markets, and government schemes.
                </p>

                <h3 data-translate="about_features">Features</h3>
                <ul style="color: var(--text-light); margin-bottom: 20px; padding-left: 20px;">
                    <li data-translate="feature1">State and District-wise agricultural insights</li>
                    <li data-translate="feature2">Crop profitability calculator</li>
                    <li data-translate="feature3">Government scheme information</li>
                    <li data-translate="feature4">Market price comparison</li>
                    <li data-translate="feature5">Map and video resources</li>
                </ul>

                <h3 data-translate="about_contact">Contact</h3>
                <p style="color: var(--text-light);">
                    <span data-translate="contact_email">Email: contact@agrosmart.com</span><br>
                    <span data-translate="contact_phone">Phone: +91 1800-XXX-XXXX</span><br>
                    <span data-translate="contact_website">Website: www.agrosmart.com</span>
                </p>
            </div>
        </div>

        <!-- PROFILE PAGE (UNCHANGED) -->
        <div class="dashboard-page pt-32 pb-12" id="profilePage">
            <div class="profile-content">
                <div class="profile-header">
                    <div class="profile-avatar">
                        <i class="fas fa-user"></i>
                    </div>
                    <h2 class="profile-name" id="profileUserName">Farmer Name</h2>
                    <p class="profile-email" id="profileUserEmail">farmer@agrosmart.com</p>
                </div>

                <!-- Farmer Profile Form -->
                <div class="farmer-profile-section">
                    <h3><i class="fas fa-farmer"></i> <span data-translate="farmer_profile">Farmer Profile</span>
                    </h3>

                    <div class="profile-form" id="farmerProfileForm">
                        <div class="form-group">
                            <label class="form-label" data-translate="label_state">Select State</label>
                            <div class="searchable-select-container" id="profileStateSearchContainer">
                                <input type="text" class="searchable-select-input" id="profileStateSearchInput"
                                    placeholder="Type to filter states..." data-translate-placeholder="type_to_filter">
                                <div class="searchable-dropdown" id="profileStateDropdown"></div>
                                <select id="profileState" style="display: none;">
                                    <option value="" data-translate="select_state">-- Select State --</option>
                                    <option value="maharashtra" data-translate="state_maharashtra">Maharashtra
                                    </option>
                                </select>
                            </div>
                        </div>

                        <div class="form-group">
                            <label class="form-label" data-translate="label_district">Select District</label>
                            <div class="searchable-select-container" id="profileDistrictSearchContainer">
                                <input type="text" class="searchable-select-input" id="profileDistrictSearchInput"
                                    placeholder="Type to filter districts..."
                                    data-translate-placeholder="type_to_filter" disabled>
                                <div class="searchable-dropdown" id="profileDistrictDropdown"></div>
                                <select id="profileDistrict" style="display: none;">
                                    <option value="" data-translate="select_district">-- Select District --</option>
                                </select>
                            </div>
                        </div>

                        <div class="form-group">
                            <label class="form-label" data-translate="label_land_area">Land Area (acres)</label>
                            <input type="number" class="form-input" id="profileLandArea" min="0.1" step="0.1" value="1">
                        </div>

                        <div class="form-group">
                            <label class="form-label" data-translate="label_seed_type">Seed Type</label>
                            <select class="form-select" id="profileSeedType">
                                <option value="">-- <span data-translate="select_seed_type">Select Seed Type</span>
                                    --</option>
                                <option value="hybrid" data-translate="seed_hybrid">Hybrid Seeds</option>
                                <option value="traditional" data-translate="seed_traditional">Traditional Seeds
                                </option>
                                <option value="bt" data-translate="seed_bt">BT Seeds</option>
                                <option value="organic" data-translate="seed_organic">Organic Seeds</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label class="form-label" data-translate="label_crop_type">Crop Type</label>
                            <select class="form-select" id="profileCropType">
                                <option value="">-- <span data-translate="select_crop_type">Select Crop Type</span>
                                    --</option>
                                <option value="cotton" data-translate="crop_cotton">Cotton</option>
                                <option value="soybean" data-translate="crop_soybean">Soybean</option>
                                <option value="sugarcane" data-translate="crop_sugarcane">Sugarcane</option>
                                <option value="wheat" data-translate="crop_wheat">Wheat</option>
                                <option value="rice" data-translate="crop_rice">Rice</option>
                                <option value="onion" data-translate="crop_onion">Onion</option>
                            </select>
                        </div>
                    </div>

                    <div class="action-buttons">
                        <button class="btn btn-primary" onclick="saveFarmerProfile()">
                            <i class="fas fa-save"></i> <span data-translate="btn_save_profile">Save Profile</span>
                        </button>
                        <button class="btn btn-secondary" onclick="clearFarmerProfile()">
                            <i class="fas fa-undo"></i> <span data-translate="btn_clear">Clear</span>
                        </button>
                    </div>

                    <div class="saved-info-card" id="savedProfileCard" style="display: none;">
                        <h4><i class="fas fa-check-circle" style="color: var(--light-green);"></i> <span
                                data-translate="saved_profile">Saved Profile</span></h4>
                        <div class="saved-info-grid" id="savedProfileInfo"></div>
                        <div class="action-buttons">
                            <button class="btn btn-primary" id="goToDistrictBtn" onclick="goToDistrictFromProfile()">
                                <i class="fas fa-map-marker-alt"></i> <span data-translate="btn_go_to_district">Go
                                    to District</span>
                            </button>
                            <button class="btn btn-secondary" onclick="fillCalculatorFromProfile()">
                                <i class="fas fa-calculator"></i> <span data-translate="btn_fill_calculator">Fill
                                    Calculator</span>
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Graphs Section -->
                <div class="profile-graphs-section" id="profileGraphsSection" style="display: none;">
                    <h3 style="color: var(--dark-green); margin-bottom: 20px;">
                        <i class="fas fa-chart-bar"></i>
                        <span data-translate="your_crop_analysis">Your Crop Analysis</span>
                    </h3>

                    <!-- Profit Analysis Graph -->
                    <div class="graph-container">
                        <div class="graph-header">
                            <div class="graph-title">
                                <i class="fas fa-chart-bar"></i>
                                <span data-translate="profit_analysis">Profit Analysis ()</span>
                            </div>
                            <div class="graph-controls">
                                <button class="btn btn-primary" onclick="showProfitDataForm()">
                                    <i class="fas fa-plus"></i> <span data-translate="add_data">Add Data</span>
                                </button>
                                <button class="btn btn-info" onclick="analyzeProfitData()">
                                    <i class="fas fa-chart-pie"></i> <span data-translate="analyze">Analyze</span>
                                </button>
                            </div>
                        </div>
                        <div class="graph-wrapper"><canvas id="profitChart"></canvas></div>

                        <!-- Data Entry Form -->
                        <div class="data-entry-form" id="profitDataForm" style="display: none;">
                            <h4 style="margin-bottom: 15px;"><i class="fas fa-plus-circle"></i> <span
                                    data-translate="add_profit_data">Add Profit Data</span></h4>
                            <div class="data-entry-grid">
                                <div class="form-group">
                                    <label class="form-label" data-translate="crop_name">Crop Name</label>
                                    <input type="text" class="form-input" id="profitCropName"
                                        placeholder="e.g., Cotton">
                                </div>
                                <div class="form-group">
                                    <label class="form-label" data-translate="season">Season</label>
                                    <select class="form-select" id="profitSeason">
                                        <option value="Kharif">Kharif</option>
                                        <option value="Rabi">Rabi</option>
                                        <option value="Summer">Summer</option>
                                        <option value="Year-round">Year-round</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label class="form-label" data-translate="profit_value">Profit ()</label>
                                    <input type="number" class="form-input" id="profitValue" min="0" step="1000"
                                        value="50000">
                                </div>
                                <div class="form-group">
                                    <button class="btn btn-primary" onclick="saveProfitData()"><i
                                            class="fas fa-save"></i> <span data-translate="save">Save</span></button>
                                    <button class="btn btn-secondary" onclick="cancelProfitData()"><i
                                            class="fas fa-times"></i> <span
                                            data-translate="cancel">Cancel</span></button>
                                </div>
                            </div>
                        </div>

                        <!-- Data List with Redesigned Delete Buttons -->
                        <div class="data-list">
                            <h4 style="margin: 20px 0 10px;"><i class="fas fa-list"></i> <span
                                    data-translate="profit_entries">Profit Entries</span></h4>
                            <div id="profitItems"></div>
                        </div>

                        <!-- Analysis Results -->
                        <div class="graph-analysis" id="profitAnalysis" style="display: none;">
                            <h4 style="margin-bottom: 15px;"><i class="fas fa-chart-line"></i> <span
                                    data-translate="profit_analysis_results">Profit Analysis Results</span></h4>
                            <div class="analysis-stats" id="profitStats"></div>
                        </div>
                    </div>

                    <!-- Yield Analysis Graph -->
                    <div class="graph-container">
                        <div class="graph-header">
                            <div class="graph-title">
                                <i class="fas fa-chart-bar"></i>
                                <span data-translate="yield_analysis">Yield Analysis (quintals)</span>
                            </div>
                            <div class="graph-controls">
                                <button class="btn btn-primary" onclick="showYieldDataForm()">
                                    <i class="fas fa-plus"></i> <span data-translate="add_data">Add Data</span>
                                </button>
                                <button class="btn btn-info" onclick="analyzeYieldData()">
                                    <i class="fas fa-chart-pie"></i> <span data-translate="analyze">Analyze</span>
                                </button>
                            </div>
                        </div>
                        <div class="graph-wrapper"><canvas id="yieldChart"></canvas></div>

                        <!-- Data Entry Form -->
                        <div class="data-entry-form" id="yieldDataForm" style="display: none;">
                            <h4 style="margin-bottom: 15px;"><i class="fas fa-plus-circle"></i> <span
                                    data-translate="add_yield_data">Add Yield Data</span></h4>
                            <div class="data-entry-grid">
                                <div class="form-group">
                                    <label class="form-label" data-translate="crop_name">Crop Name</label>
                                    <input type="text" class="form-input" id="yieldCropName" placeholder="e.g., Wheat">
                                </div>
                                <div class="form-group">
                                    <label class="form-label" data-translate="season">Season</label>
                                    <select class="form-select" id="yieldSeason">
                                        <option value="Kharif">Kharif</option>
                                        <option value="Rabi">Rabi</option>
                                        <option value="Summer">Summer</option>
                                        <option value="Year-round">Year-round</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label class="form-label" data-translate="yield_value">Yield (quintals)</label>
                                    <input type="number" class="form-input" id="yieldValue" min="0" step="1" value="50">
                                </div>
                                <div class="form-group">
                                    <button class="btn btn-primary" onclick="saveYieldData()"><i
                                            class="fas fa-save"></i> <span data-translate="save">Save</span></button>
                                    <button class="btn btn-secondary" onclick="cancelYieldData()"><i
                                            class="fas fa-times"></i> <span
                                            data-translate="cancel">Cancel</span></button>
                                </div>
                            </div>
                        </div>

                        <!-- Data List with Redesigned Delete Buttons -->
                        <div class="data-list">
                            <h4 style="margin: 20px 0 10px;"><i class="fas fa-list"></i> <span
                                    data-translate="yield_entries">Yield Entries</span></h4>
                            <div id="yieldItems"></div>
                        </div>

                        <!-- Analysis Results -->
                        <div class="graph-analysis" id="yieldAnalysis" style="display: none;">
                            <h4 style="margin-bottom: 15px;"><i class="fas fa-chart-line"></i> <span
                                    data-translate="yield_analysis_results">Yield Analysis Results</span></h4>
                            <div class="analysis-stats" id="yieldStats"></div>
                        </div>
                    </div>
                </div>

                <button class="profile-logout-btn" onclick="logout()">
                    <i class="fas fa-sign-out-alt"></i>
                    <span data-translate="btn_logout">Logout</span>
                </button>
            </div>
        </div>
    </div>

    <!-- GREEN CHATBOT -->
    <div class="chatbot-container">
        <div class="chatbot-window" id="chatbotWindow">
            <div class="chatbot-header">
                <div class="chatbot-title">
                    <i class="fas fa-robot"></i>
                    <span data-translate="chatbot_name">KrishiMitra</span>
                </div>
                <button class="chatbot-close" id="closeChatbot"><i class="fas fa-times"></i></button>
            </div>
            <div class="chatbot-body" id="chatbotBody">
                <div class="chat-message bot-message">
                    <span data-translate="chat_welcome">Hello! I'm KrishiMitra, your agricultural assistant. How can
                        I help you today?</span>
                </div>
                <div class="chatbot-features-list" id="chatbotFeaturesList"></div>
            </div>
            <div class="chatbot-input">
                <input type="text" id="chatbotInput" placeholder="Type your question here..."
                    data-translate-placeholder="chat_placeholder">
                <button id="sendChatbotMessage"><i class="fas fa-paper-plane"></i></button>
            </div>
        </div>
        <button class="chatbot-btn" id="openChatbot"><i class="fas fa-robot"></i></button>
    </div>

    <!-- Footer -->
    <footer>
        <div class="footer-content">
            <div class="footer-logo"><i class="fas fa-seedling"></i><span>AgroSmart</span></div>
            <p data-translate="footer_desc">Empowering farmers with intelligent agricultural insights and
                data-driven decision making.</p>
            <div class="footer-links">
                <a href="#" data-translate="footer_website">agrosmart.com</a>
                <a href="#" data-translate="footer_email">contact@agrosmart.com</a>
                <a href="#" data-translate="footer_phone">+91 1800-XXX-XXXX</a>
            </div>
            <p class="copyright" data-translate="footer_copyright"> 2023 AgroSmart. All rights reserved.</p>
        </div>
    </footer>
    </div>

    <script>
        // COMPLETE TRANSLATIONS OBJECT - ALL LANGUAGES (simplified for space)
        const translations = {
            en: {
                // Login
                "login_welcome": "Welcome to AgroSmart",
                "login_subtitle": "Please login to access your account",
                "email_placeholder": "Email",
                "password_placeholder": "Password",
                "btn_login": "Login",
                "btn_logout": "Logout",
                "invalid_credentials": "Invalid email or password",
                "demo_message": "This is a demo application. Use any email and password.",
                "demo_hint": "E.g: farmer@agrosmart.com / any password",

                // Navigation
                "nav_dashboard": "Dashboard",
                "nav_about": "About",
                "btn_back": "Back",
                "btn_back_dashboard": "Back to Dashboard",

                // Dashboard
                "dashboard_title": "AgroSmart Dashboard",
                "dashboard_desc": "Your intelligent agricultural companion providing data-driven insights for farmers across India.",
                "welcome_title": "Welcome to AgroSmart",
                "welcome_desc": "Get detailed agricultural insights for districts across India including top crops, seasons, demand, risk factors, and market information.",

                // Feature Cards
                "feature_quick_analysis": "Maharashtra Crop Advisor",
                "feature_quick_desc": "Get personalized crop recommendations for your village",
                "feature_schemes": "Government Schemes",
                "feature_schemes_desc": "Find subsidies, insurance, and support programs for farmers",
                "feature_markets": "Market Prices",
                "feature_markets_desc": "Compare crop prices across different markets",
                "feature_calculator": "Profit Calculator",
                "feature_calculator_desc": "Calculate profit and expenses for crops",
                "btn_analyze": "Analyze",
                "btn_view": "View Schemes",
                "btn_compare": "Compare",
                "btn_calculate": "Calculate",

                // Quick Analysis Page
                "quick_analysis_title": "Maharashtra District Analysis",
                "quick_analysis_desc": "Select a district to get personalized crop recommendations",
                "btn_view_details": "Get Recommendations",

                // Stats
                "stats_states": "States Covered",
                "stats_states_label": "Agricultural States in India",
                "with_detailed_data": "with detailed data",
                "stats_districts": "Districts Analyzed",
                "stats_districts_label": "With Detailed Insights",
                "across_india": "across India",

                // Insights
                "insights_title": "Quick Insights",
                "insights_demand": "High Demand Crops",
                "insights_risk": "High Risk Areas",
                "insights_export": "Export Potential",

                // Form Labels
                "label_state": "Select State",
                "label_district": "Select District",
                "label_crop": "Select Crop",
                "label_crop_desc": "Choose from recommended crops",
                "label_area": "Cultivation Area",
                "label_area_desc": "In acres",
                "label_yield": "Expected Yield",
                "label_yield_desc": "Quintal per acre",
                "label_price": "Expected Price",
                "label_price_desc": " per quintal",
                "label_seeds": "Seeds Cost",
                "label_seeds_desc": " per acre",
                "label_fertilizer": "Fertilizers Cost",
                "label_fertilizer_desc": " per acre",
                "label_pesticide": "Pesticides Cost",
                "label_pesticide_desc": " per acre",
                "label_irrigation": "Irrigation Cost",
                "label_irrigation_desc": " per acre",
                "label_labor": "Labor Cost",
                "label_labor_desc": " per acre",
                "label_other": "Other Costs",
                "label_other_desc": " per acre",
                "label_land_area": "Land Area (acres)",
                "label_seed_type": "Seed Type",
                "label_crop_type": "Crop Type",

                // Dropdown options
                "select_state": "-- Select State --",
                "select_district": "-- Select District --",
                "select_seed_type": "-- Select Seed Type --",
                "select_crop_type": "-- Select Crop Type --",
                "all_states": "All States",
                "state_maharashtra": "Maharashtra",
                "type_to_filter": "Type to filter...",

                // Seed types
                "seed_hybrid": "Hybrid Seeds",
                "seed_traditional": "Traditional Seeds",
                "seed_bt": "BT Seeds",
                "seed_organic": "Organic Seeds",

                // Crops
                "crop_cotton": "Cotton",
                "crop_soybean": "Soybean",
                "crop_sugarcane": "Sugarcane",
                "crop_wheat": "Wheat",
                "crop_rice": "Rice",
                "crop_onion": "Onion",
                "crop_tur": "Tur (Arhar)",
                "crop_jowar": "Jowar",

                // Districts
                "district_amravati": "Amravati",
                "district_ahmednagar": "Ahmednagar",

                // Calculator
                "calculator_title": "Agricultural Profit Calculator",
                "calculator_subtitle": "Calculate expected profits for crops in this district",
                "calculator_page_title": "Profit Calculator",
                "calculator_page_desc": "Calculate profit and expenses for your crops. Use basic or advanced calculator.",
                "tab_basic": "Basic Calculator",
                "tab_advanced": "Advanced Calculator",
                "tab_compare": "Compare Crops",
                "results_title": "Profit Calculation Results",
                "results_detailed": "Detailed Profit Calculation",
                "profit": "PROFIT",
                "loss": "LOSS",
                "advanced_desc": "Detailed expense calculator with custom inputs for accurate profit estimation.",
                "compare_desc": "Compare profitability of different crops in this district.",
                "select_crop1": "Select Crop 1",
                "select_crop2": "Select Crop 2",
                "btn_compare_crops": "Compare Crops",
                "btn_calculate_detailed": "Calculate Detailed Profit",
                "btn_reset": "Reset",
                "revenue": "Total Revenue",
                "expenses": "Total Expenses",
                "profit_per_acre": "Profit per Acre",
                "expense_breakdown": "Expense Breakdown",

                // Government Schemes
                "schemes_title": "Government Schemes for Farmers",
                "schemes_desc": "Explore various government schemes, subsidies, and support programs available for Indian farmers",
                "search_scheme_placeholder": "Search for schemes (e.g. PM-KISAN, Crop Insurance...)",
                "showing_schemes": "Showing 5 schemes",
                "search_type": "Type to filter",
                "benefits": "Benefits",
                "btn_apply": "Apply Now",

                // Markets
                "markets_title": "Market Price Comparison",
                "markets_desc": "Compare crop prices across different markets and find the best price.",
                "markets_filter": "Market Filter",
                "markets_filter_desc": "Select crop and state to view market prices",
                "market_date": "Date",
                "btn_search_markets": "Search Markets",
                "markets_results": "Market Price Results",
                "market_name": "Market",
                "crop": "Crop",
                "price": "Price (/quintal)",
                "change": "Change",
                "date": "Date",

                // Profile
                "farmer_profile": "Farmer Profile",
                "saved_profile": "Saved Profile",
                "btn_save_profile": "Save Profile",
                "btn_clear": "Clear",
                "btn_go_to_district": "Go to District",
                "btn_fill_calculator": "Fill Calculator",

                // Graphs
                "your_crop_analysis": "Your Crop Analysis",
                "profit_analysis": "Profit Analysis ()",
                "yield_analysis": "Yield Analysis (quintals)",
                "add_data": "Add Data",
                "analyze": "Analyze",
                "save": "Save",
                "cancel": "Cancel",
                "crop_name": "Crop Name",
                "profit_value": "Profit ()",
                "yield_value": "Yield (quintals)",
                "average": "Average",
                "highest": "Highest",
                "lowest": "Lowest",
                "delete": "Delete",
                "profit_entries": "Profit Entries",
                "yield_entries": "Yield Entries",
                "add_profit_data": "Add Profit Data",
                "add_yield_data": "Add Yield Data",
                "profit_analysis_results": "Profit Analysis Results",
                "yield_analysis_results": "Yield Analysis Results",

                // About
                "about_title": "About AgroSmart",
                "about_mission": "Our Mission",
                "about_mission_desc": "AgroSmart aims to empower Indian farmers with data-driven agricultural insights, helping them make informed decisions about crops, markets, and government schemes.",
                "about_features": "Features",
                "feature1": "State and District-wise agricultural insights",
                "feature2": "Crop profitability calculator",
                "feature3": "Government scheme information",
                "feature4": "Market price comparison",
                "feature5": "Map and video resources",
                "about_contact": "Contact",
                "contact_email": "Email: contact@agrosmart.com",
                "contact_phone": "Phone: +91 1800-XXX-XXXX",
                "contact_website": "Website: www.agrosmart.com",

                // Footer
                "footer_desc": "Empowering farmers with intelligent agricultural insights and data-driven decision making.",
                "footer_website": "agrosmart.com",
                "footer_email": "contact@agrosmart.com",
                "footer_phone": "+91 1800-XXX-XXXX",
                "footer_copyright": " 2023 AgroSmart. All rights reserved.",

                // Chatbot
                "chatbot_name": "KrishiMitra",
                "chat_welcome": "Hello! I'm KrishiMitra, your agricultural assistant. How can I help you today?",
                "chat_placeholder": "Type your question here...",

                // Alerts
                "alert_fill_fields": "Please fill all fields",
                "alert_select_two": "Please select two crops to compare",
                "alert_select_different": "Please select two different crops",
                "apply_clicked": "Application form would open here",
                "map_placeholder": "Map of {district} will appear here when added",
                "video_placeholder": "Crop cultivation videos for {district} will appear here when added",
                "first": "first",
                "of": "of",
                "no_data": "No data available",

                // Recommendations
                "recommend_high_demand": "High market demand presents good opportunity for commercial cultivation.",
                "recommend_high_risk": "Consider crop insurance and diversified cropping to mitigate risks.",
                "recommend_low_risk": "Low risk environment suitable for stable crop production.",
                "recommend_export": "Good export potential - consider quality standards and export-oriented varieties.",
                "recommend_market": "Good access to global markets through nearby ports and infrastructure."
            }
        };

        // Maharashtra Villages Database
        const maharashtraVillages = {
            "akola": ["Borgaon", "Patur", "Barshi Takli", "Murtijapur", "Akot", "Telhara", "Balapur", "Washim", "Malegaon", "Daryapur"],
            "ahmednagar": ["Shrigonda", "Karjat", "Jamkhed", "Pathardi", "Shevgaon", "Nevasa", "Rahuri", "Sangamner", "Kopargaon", "Shrirampur"],
            "amravati": ["Chandur", "Daryapur", "Achalpur", "Morshi", "Warud", "Dharni", "Chikhaldara", "Anjangaon", "Tiwsa", "Nandgaon"],
            "aurangabad": ["Kannad", "Gangapur", "Paithan", "Phulambri", "Khuldabad", "Sillod", "Vaijapur", "Soegaon", "Lasur", "Waluj"],
            "buldhana": ["Malkapur", "Chikhli", "Sindkhed Raja", "Mehkar", "Khamgaon", "Nandura", "Lonar", "Deulgaon Raja", "Jalgaon", "Sangrampur"],
            "nashik": ["Niphad", "Yeola", "Malegaon", "Satana", "Dindori", "Peth", "Igatpuri", "Trimbakeshwar", "Chandwad", "Kalwan"],
            "nagpur": ["Katol", "Ramtek", "Saoner", "Hingna", "Kalmeshwar", "Narkhed", "Umred", "Bhiwapur", "Kuhi", "Parseoni"],
            "pune": ["Shirur", "Baramati", "Indapur", "Daund", "Junnar", "Ambegaon", "Velhe", "Purandar", "Bhor", "Maval"],
            "kolhapur": ["Shirol", "Hatkanangale", "Karveer", "Panhala", "Kagal", "Radhanagari", "Bhudargad", "Ajra", "Gadhinglaj"],
            "sangli": ["Miraj", "Tasgaon", "Kavathe Mahankal", "Jat", "Khanapur", "Palus", "Shirala", "Walva"],
            "satara": ["Karad", "Patan", "Phaltan", "Mahabaleshwar", "Wai", "Koregaon", "Jaoli", "Khandala"],
            "solapur": ["Pandharpur", "Mangalwedha", "Mohol", "Madha", "Barshi", "Akkalkot", "Karmala", "Sangola"],
            "jalgaon": ["Chalisgaon", "Bhusawal", "Pachora", "Jamner", "Erandol", "Dharangaon", "Parola", "Amalner"],
            "dhule": ["Shirpur", "Sindkheda", "Sakri", "Dhadgaon"],
            "nanded": ["Kinwat", "Hadgaon", "Bhokar", "Umarkhed", "Deglur", "Mukhed", "Loha", "Kandhar"],
            "latur": ["Udgir", "Ahmadpur", "Chakur", "Shirur Anantpal", "Jalkot", "Nilanga", "Renapur", "Aus"],
            "osmanabad": ["Tuljapur", "Umarga", "Lohara", "Kallamb", "Bhoom", "Paranda", "Washi"],
            "beed": ["Ambajogai", "Georai", "Majalgaon", "Wadwani", "Ashti", "Patoda", "Shirur", "Kaij"],
            "wardha": ["Hinganghat", "Arvi", "Deoli", "Seloo", "Samudrapur", "Karanja"],
            "yavatmal": ["Darwha", "Digras", "Pusad", "Umarkhed", "Wani", "Kelapur", "Ralegaon", "Bab hulgaon", "Mahagaon"]
        };

        // Market Data
        const marketData = [
            { market: "Akola APMC", crop: "Cotton", state: "maharashtra", price: 7200, change: "+2.5%", date: "2024-03-15" },
            { market: "Akola APMC", crop: "Soybean", state: "maharashtra", price: 4800, change: "-1.2%", date: "2024-03-15" },
            { market: "Ahmednagar APMC", crop: "Sugarcane", state: "maharashtra", price: 3500, change: "+0.8%", date: "2024-03-15" },
            { market: "Ahmednagar APMC", crop: "Onion", state: "maharashtra", price: 2100, change: "+5.0%", date: "2024-03-15" },
            { market: "Amravati APMC", crop: "Cotton", state: "maharashtra", price: 7100, change: "+1.8%", date: "2024-03-15" },
            { market: "Amravati APMC", crop: "Soybean", state: "maharashtra", price: 4750, change: "-0.5%", date: "2024-03-15" },
            { market: "Ludhiana Mandi", crop: "Wheat", state: "punjab", price: 2650, change: "+0.3%", date: "2024-03-15" },
            { market: "Ludhiana Mandi", crop: "Rice", state: "punjab", price: 3150, change: "+1.2%", date: "2024-03-15" },
            { market: "Ahmedabad APMC", crop: "Cotton", state: "gujarat", price: 7350, change: "+3.2%", date: "2024-03-15" },
            { market: "Belagavi APMC", crop: "Sugarcane", state: "karnataka", price: 3450, change: "+0.9%", date: "2024-03-15" }
        ];

        // Government Schemes Data
        const governmentSchemesData = [
            {
                id: "pmkisan",
                title: { en: "Pradhan Mantri Kisan Samman Nidhi (PM-KISAN)", mr: "    (-)", hi: "    (-)" },
                description: { en: "Income support scheme for farmer families", mr: "    ", hi: "      " },
                benefits: { en: "6,000 per year in three equal installments", mr: "    ,", hi: "      ," }
            },
            {
                id: "pmfby",
                title: { en: "Pradhan Mantri Fasal Bima Yojana (PMFBY)", mr: "    ()", hi: "    ()" },
                description: { en: "Crop insurance scheme", mr: "  ", hi: "  " },
                benefits: { en: "Premium as low as 1.5-5% for all crops", mr: "   .-% ", hi: "     .-% " }
            },
            {
                id: "microirrigation",
                title: { en: "Micro Irrigation Fund Scheme", mr: "   ", hi: "   " },
                description: { en: "Promotes micro-irrigation", mr: "- ", hi: "-  " },
                benefits: { en: "Up to 55% subsidy on micro-irrigation systems", mr: "-  %  ", hi: "-   %  " }
            },
            {
                id: "soilhealth",
                title: { en: "Soil Health Card Scheme", mr: "   ", hi: "   " },
                description: { en: "Provides soil health cards", mr: "   ", hi: "   " },
                benefits: { en: "Customized fertilizer recommendations", mr: "  ", hi: "  " }
            },
            {
                id: "kcc",
                title: { en: "Kisan Credit Card (KCC) Scheme", mr: "   () ", hi: "   () " },
                description: { en: "Provides affordable credit", mr: " ", hi: " " },
                benefits: { en: "Credit up to 3 lakh at 4% interest", mr: " %     ", hi: "  %       " }
            }
        ];

        // Global Variables
        let currentState = null;
        let currentDistrict = null;
        let currentLanguage = 'en';
        let chatbotMode = null;
        let farmerProfile = null;

        // Graph Data Arrays
        let profitData = [
            { crop: "Cotton", season: "Kharif", value: 85000 },
            { crop: "Sugarcane", season: "Year-round", value: 120000 },
            { crop: "Soybean", season: "Kharif", value: 65000 },
            { crop: "Wheat", season: "Rabi", value: 45000 },
            { crop: "Tur", season: "Kharif", value: 55000 }
        ];

        let yieldData = [
            { crop: "Cotton", season: "Kharif", value: 25 },
            { crop: "Sugarcane", season: "Year-round", value: 120 },
            { crop: "Soybean", season: "Kharif", value: 20 },
            { crop: "Wheat", season: "Rabi", value: 35 },
            { crop: "Tur", season: "Kharif", value: 15 }
        ];

        // Chart instances
        let profitChart = null;
        let yieldChart = null;

        const pages = {
            dashboard: document.getElementById('dashboardPage'),
            quickAnalysis: document.getElementById('quickAnalysisPage'),
            districtDetails: document.getElementById('districtDetailsPage'),
            governmentSchemes: document.getElementById('governmentSchemesPage'),
            markets: document.getElementById('marketsPage'),
            about: document.getElementById('aboutPage'),
            calculator: document.getElementById('calculatorPage'),
            profile: document.getElementById('profilePage')
        };

        // ============================================
        // SEARCHABLE DROPDOWN FUNCTIONS
        // ============================================
        function createSearchableDropdown(inputId, dropdownId, selectId, options, onSelect) {
            const input = document.getElementById(inputId);
            const dropdown = document.getElementById(dropdownId);
            const select = document.getElementById(selectId);

            if (!input || !dropdown || !select) return;

            function renderDropdown(filter = '') {
                const filteredOptions = options.filter(opt =>
                    opt.text.toLowerCase().includes(filter.toLowerCase()) || opt.value === ''
                );

                dropdown.innerHTML = filteredOptions.map(opt =>
                    `<div class="searchable-option ${opt.value === select.value ? 'selected' : ''}" data-value="${opt.value}">${opt.text}</div>`
                ).join('');

                dropdown.querySelectorAll('.searchable-option').forEach(opt => {
                    opt.addEventListener('click', function () {
                        const value = this.dataset.value;
                        const text = this.textContent;

                        select.value = value;
                        input.value = text;

                        const event = new Event('change', { bubbles: true });
                        select.dispatchEvent(event);

                        dropdown.classList.remove('active');

                        if (onSelect) onSelect(value, text);
                    });
                });
            }

            renderDropdown();

            input.addEventListener('focus', () => {
                dropdown.classList.add('active');
                renderDropdown(input.value);
            });

            input.addEventListener('input', () => {
                dropdown.classList.add('active');
                renderDropdown(input.value);
            });

            document.addEventListener('click', (e) => {
                if (!input.contains(e.target) && !dropdown.contains(e.target)) {
                    dropdown.classList.remove('active');
                }
            });

            input.addEventListener('keydown', (e) => {
                if (e.key === 'Escape') {
                    dropdown.classList.remove('active');
                }
            });
        }

        // ============================================
        // LANGUAGE FUNCTIONS
        // ============================================
        function changeLanguage(lang) {
            currentLanguage = lang;
            document.querySelectorAll('.language-switcher .lang-btn, .login-lang-btn').forEach(btn => {
                btn.classList.remove('active');
                if (btn.dataset.lang === lang) btn.classList.add('active');
            });
            updateTranslations();

            if (document.getElementById('mainApp').classList.contains('authenticated')) {
                updateDashboardStats();
                loadGovernmentSchemes();
                updateChatbotFeatures();
                updateChatbotWelcome();
                updateDistrictDropdowns();
                updateCharts();
                renderProfitItems();
                renderYieldItems();
            }
        }

        function changeLoginLanguage(lang) {
            currentLanguage = lang;
            document.querySelectorAll('.login-lang-btn').forEach(btn => {
                btn.classList.remove('active');
                if (btn.dataset.lang === lang) btn.classList.add('active');
            });
            updateTranslations();
        }

        function updateTranslations() {
            document.querySelectorAll('[data-translate]').forEach(el => {
                const key = el.dataset.translate;
                if (translations[currentLanguage] && translations[currentLanguage][key]) {
                    if (el.tagName === 'INPUT' || el.tagName === 'TEXTAREA') {
                        if (el.placeholder !== undefined) el.placeholder = translations[currentLanguage][key];
                    } else if (el.tagName === 'OPTION') {
                        el.textContent = translations[currentLanguage][key];
                    } else {
                        el.textContent = translations[currentLanguage][key];
                    }
                }
            });

            document.querySelectorAll('[data-translate-placeholder]').forEach(el => {
                const key = el.dataset.translatePlaceholder;
                if (translations[currentLanguage] && translations[currentLanguage][key]) {
                    el.placeholder = translations[currentLanguage][key];
                }
            });
        }

        function showPage(pageName) {
            Object.values(pages).forEach(page => {
                if (page) page.classList.remove('active');
            });
            if (pages[pageName]) {
                pages[pageName].classList.add('active');
            }
        }

        // ============================================
        // DASHBOARD FUNCTIONS
        // ============================================
        function updateDashboardStats() {
            let totalDistricts = Object.keys(maharashtraVillages).length;
            document.getElementById('statesCount').textContent = "1";
            document.getElementById('districtsCount').textContent = totalDistricts;
        }

        // ============================================
        // DROPDOWN FUNCTIONS
        // ============================================
        function updateDistrictDropdowns() {
            // Quick Analysis district dropdown (Maharashtra only)
            const districtSelect = document.getElementById('quickDistrictSelect');
            const districtOptions = [
                { value: "", text: "-- Select District --" },
                { value: "akola", text: "Akola" },
                { value: "ahmednagar", text: "Ahmednagar" },
                { value: "amravati", text: "Amravati" },
                { value: "aurangabad", text: "Aurangabad" },
                { value: "buldhana", text: "Buldhana" },
                { value: "nashik", text: "Nashik" },
                { value: "nagpur", text: "Nagpur" },
                { value: "pune", text: "Pune" },
                { value: "kolhapur", text: "Kolhapur" },
                { value: "sangli", text: "Sangli" },
                { value: "satara", text: "Satara" },
                { value: "solapur", text: "Solapur" },
                { value: "jalgaon", text: "Jalgaon" },
                { value: "dhule", text: "Dhule" },
                { value: "nanded", text: "Nanded" },
                { value: "latur", text: "Latur" },
                { value: "osmanabad", text: "Osmanabad" },
                { value: "beed", text: "Beed" },
                { value: "wardha", text: "Wardha" },
                { value: "yavatmal", text: "Yavatmal" }
            ];

            createSearchableDropdown('districtSearchInput', 'districtDropdown', 'quickDistrictSelect', districtOptions, (value) => {
                // Village dropdown will be populated when district is selected
                updateVillageDropdown(value);
            });

            // Water Source dropdown
            const waterSourceOptions = [
                { value: "Well", text: "Well" },
                { value: "Borewell", text: "Borewell" },
                { value: "Canal", text: "Canal" },
                { value: "Farm Pond", text: "Farm Pond" },
                { value: "River", text: "River" }
            ];
            createSearchableDropdown('waterSourceInput', 'waterSourceDropdown', 'waterSource', waterSourceOptions, null);

            // Water Level dropdown
            const waterLevelOptions = [
                { value: "Low", text: "Low" },
                { value: "Medium", text: "Medium" },
                { value: "High", text: "High" }
            ];
            createSearchableDropdown('waterLevelInput', 'waterLevelDropdown', 'waterLevel', waterLevelOptions, null);

            // Budget dropdown
            const budgetOptions = [
                { value: "Low", text: "Low Investment" },
                { value: "Medium", text: "Medium Investment" },
                { value: "High", text: "High Investment" }
            ];
            createSearchableDropdown('budgetInput', 'budgetDropdown', 'budgetLevel', budgetOptions, null);

            // Soil dropdown
            const soilOptions = [
                { value: "Black", text: "Black Soil" },
                { value: "Red", text: "Red Soil" },
                { value: "Sandy Loam", text: "Sandy Loam" },
                { value: "Laterite", text: "Laterite Soil" }
            ];
            createSearchableDropdown('soilInput', 'soilDropdown', 'soilType', soilOptions, null);
        }

        function updateVillageDropdown(districtId) {
            const villageInput = document.getElementById('villageSearchInput');
            const villageSelect = document.getElementById('villageSelect');

            if (!districtId) {
                villageInput.disabled = true;
                villageInput.value = '';
                villageInput.placeholder = "Select district first";
                return;
            }

            const villages = maharashtraVillages[districtId] || [];
            const villageOptions = [
                { value: "", text: "-- Select Village --" },
                ...villages.map(v => ({ value: v.toLowerCase().replace(/\s+/g, ''), text: v }))
            ];

            // Populate hidden select
            villageSelect.innerHTML = villageOptions.map(opt =>
                `<option value="${opt.value}">${opt.text}</option>`
            ).join('');

            villageInput.disabled = false;
            villageInput.placeholder = "Type to filter villages...";

            createSearchableDropdown('villageSearchInput', 'villageDropdown', 'villageSelect', villageOptions, null);
        }

        // ============================================
        // QUICK ANALYSIS FUNCTIONS
        // ============================================
        function viewQuickDistrict() {
            const districtId = document.getElementById('quickDistrictSelect').value;

            if (!districtId) {
                alert(translations[currentLanguage]['alert_fill_fields']);
                return;
            }

            const district = districtId.charAt(0).toUpperCase() + districtId.slice(1);

            currentDistrict = { id: districtId, name: district };

            showPage('districtDetails');
            document.getElementById('districtDetailsTitle').textContent = `Maharashtra - ${district} District`;

            // Update village dropdown with this district's villages
            updateVillageDropdown(districtId);

            // Reset recommendation report
            document.getElementById('recommendationReport').style.display = 'none';

            // Load map and YouTube (placeholder)
            loadDistrictMap(district);
            loadDistrictYoutubeVideos(district);

            // Set recommendations text
            document.getElementById('districtRecommendations').innerHTML = getDistrictRecommendations(districtId);

            // Setup calculator with district crops
            setupDistrictCalculator(districtId);
        }

        function loadDistrictMap(district) {
            const container = document.getElementById('districtMapContainer');
            container.innerHTML = `
                <div class="upload-placeholder">
                    <i class="fas fa-map-marked-alt"></i>
                    <h4>${district} District Map</h4>
                    <p style="color: var(--text-light); margin-top: 10px;">Interactive map will appear here</p>
                </div>
            `;
        }

        function loadDistrictYoutubeVideos(district) {
            const container = document.getElementById('youtubeVideosContainer');
            container.innerHTML = `
                <div class="video-placeholder">
                    <i class="fab fa-youtube"></i>
                    <h4>Farming Videos for ${district}</h4>
                    <p style="color: var(--text-light); margin-top: 10px;">Crop cultivation videos will appear here</p>
                </div>
            `;
        }

        function getDistrictRecommendations(districtId) {
            const recommendations = {
                "akola": "Akola is known for cotton and soybean. Consider crop rotation with pulses to maintain soil health.",
                "ahmednagar": "Ahmednagar has good sugarcane and onion potential. Ensure adequate irrigation for best yields.",
                "amravati": "Amravati region is suitable for cotton and soybean. Watch out for pest outbreaks.",
                "aurangabad": "Aurangabad has potential for tur and soybean. Consider drought-resistant varieties.",
                "buldhana": "Buldhana is good for soybean and pulses. Practice integrated pest management.",
                "nashik": "Nashik is ideal for grapes, onions, and vegetables. Focus on quality for export markets.",
                "nagpur": "Nagpur region is known for oranges and cotton. Maintain proper spacing for orchards.",
                "pune": "Pune has diverse cropping options including sugarcane, onions, and vegetables.",
                "kolhapur": "Kolhapur is excellent for sugarcane. Consider intercropping with vegetables.",
                "sangli": "Sangli is known for grapes and sugarcane. Focus on export quality standards.",
                "satara": "Satara has good potential for sugarcane and vegetables. Ensure timely irrigation.",
                "solapur": "Solapur is suitable for jowar and pulses. Consider drought-tolerant varieties.",
                "jalgaon": "Jalgaon is famous for bananas. Practice proper bunch management.",
                "dhule": "Dhule has potential for cotton and maize. Watch for pest incidence.",
                "nanded": "Nanded is good for cotton and soybean. Consider soil testing for nutrient management.",
                "latur": "Latur is known for tur and soybean. Practice integrated nutrient management.",
                "osmanabad": "Osmanabad has potential for pulses and oilseeds. Conserve soil moisture.",
                "beed": "Beed is suitable for cotton and soybean. Watch for pink bollworm in cotton.",
                "wardha": "Wardha has good potential for oranges and cotton. Maintain proper orchard management.",
                "yavatmal": "Yavatmal is known as cotton district. Practice integrated pest management."
            };
            return recommendations[districtId] || "This district has diverse agricultural potential. Consider soil testing before planting.";
        }

        function setupDistrictCalculator(districtId) {
            const districtCrops = {
                "akola": ["Cotton", "Soybean", "Tur"],
                "ahmednagar": ["Sugarcane", "Onion", "Bajra"],
                "amravati": ["Cotton", "Soybean"],
                "aurangabad": ["Tur", "Soybean"],
                "buldhana": ["Soybean", "Pulses"],
                "nashik": ["Grapes", "Onion", "Tomato"],
                "nagpur": ["Orange", "Cotton"],
                "pune": ["Sugarcane", "Onion", "Tomato"],
                "kolhapur": ["Sugarcane", "Vegetables"],
                "sangli": ["Grapes", "Sugarcane"],
                "satara": ["Sugarcane", "Vegetables"],
                "solapur": ["Jowar", "Pulses"],
                "jalgaon": ["Banana", "Cotton"],
                "dhule": ["Cotton", "Maize"],
                "nanded": ["Cotton", "Soybean"],
                "latur": ["Tur", "Soybean"],
                "osmanabad": ["Pulses", "Oilseeds"],
                "beed": ["Cotton", "Soybean"],
                "wardha": ["Orange", "Cotton"],
                "yavatmal": ["Cotton", "Pulses"]
            };

            const crops = districtCrops[districtId] || ["Cotton", "Soybean", "Tur"];

            ['cropSelect', 'advancedCropSelect', 'crop1Select', 'crop2Select'].forEach(selectId => {
                const select = document.getElementById(selectId);
                if (select) {
                    select.innerHTML = `<option value="">Select Crop</option>` +
                        crops.map(crop => `<option value="${crop}">${crop}</option>`).join('');
                }
            });
        }

        // ============================================
        // CROP RECOMMENDATION FUNCTION
        // ============================================
        function generateCropRecommendation() {
            const district = currentDistrict?.name || "Selected";
            const village = document.getElementById('villageSelect')?.value ?
                document.getElementById('villageSelect').options[document.getElementById('villageSelect').selectedIndex]?.text : "";
            const landSize = parseFloat(document.getElementById('landSize')?.value) || 5;
            const waterSource = document.getElementById('waterSource')?.value || "Borewell";
            const waterLevel = document.getElementById('waterLevel')?.value || "Medium";
            const budgetLevel = document.getElementById('budgetLevel')?.value || "Medium";
            const soilType = document.getElementById('soilType')?.value || "Black";

            if (!village) {
                alert("Please select a village");
                return;
            }

            // Determine season based on month
            const month = new Date().getMonth() + 1;
            let season = "Kharif";
            if (month >= 10 && month <= 3) season = "Rabi";
            else if (month >= 4 && month <= 6) season = "Summer";

            // Generate recommendations based on inputs
            let crop1, crop2, crop3;
            let suitability1, suitability2, suitability3;
            let profit1, profit2, profit3;
            let risk1, risk2, risk3;
            let market1, market2, market3;

            // Soil-based adjustments
            if (soilType.includes("Black")) {
                crop1 = "Cotton";
                crop2 = "Soybean";
                crop3 = "Tur";
                suitability1 = waterLevel === "High" ? 95 : (waterLevel === "Medium" ? 88 : 75);
                suitability2 = 87;
                suitability3 = 82;
                profit1 = waterLevel === "High" ? "45,000  65,000" : "38,000  55,000";
                profit2 = "35,000  50,000";
                profit3 = "32,000  45,000";
                risk1 = waterLevel === "Low" ? "High" : "Medium";
                risk2 = "Medium";
                risk3 = "Low";
                market1 = "Akola/Mumbai APMC, Textile Mills";
                market2 = "Local Mandi, Oil Mills";
                market3 = "Local Wholesale, Latur Market";
            } else if (soilType.includes("Red")) {
                crop1 = "Groundnut";
                crop2 = "Jowar";
                crop3 = "Pulses";
                suitability1 = 86;
                suitability2 = 84;
                suitability3 = 79;
                profit1 = "38,000  52,000";
                profit2 = "25,000  35,000";
                profit3 = "28,000  40,000";
                risk1 = "Medium";
                risk2 = "Low";
                risk3 = "Low";
                market1 = "Oil Mills, Local Market";
                market2 = "Local Mandi, Poultry Feed";
                market3 = "Local Traders";
            } else if (soilType.includes("Sandy")) {
                crop1 = "Onion";
                crop2 = "Bajra";
                crop3 = "Vegetables";
                suitability1 = 89;
                suitability2 = 82;
                suitability3 = 76;
                profit1 = "40,000  60,000";
                profit2 = "22,000  32,000";
                profit3 = "35,000  55,000";
                risk1 = "Medium";
                risk2 = "Low";
                risk3 = "Medium";
                market1 = "Lasalgaon Market, Local Mandi";
                market2 = "Local Market, Feed Industry";
                market3 = "Local Vegetable Market";
            } else {
                crop1 = "Sugarcane";
                crop2 = "Banana";
                crop3 = "Vegetables";
                suitability1 = waterLevel === "High" ? 94 : 80;
                suitability2 = 85;
                suitability3 = 78;
                profit1 = "80,000  1,20,000";
                profit2 = "50,000  80,000";
                profit3 = "35,000  55,000";
                risk1 = waterLevel === "Low" ? "High" : "Medium";
                risk2 = "Medium";
                risk3 = "Low";
                market1 = "Sugar Factories, Jaggery Market";
                market2 = "Local Market, Distant Markets";
                market3 = "Local Vegetable Market";
            }

            // Budget adjustments
            if (budgetLevel === "Low") {
                profit1 = profit1.replace(/\d+/g, m => Math.floor(parseInt(m) * 0.8));
                profit2 = profit2.replace(/\d+/g, m => Math.floor(parseInt(m) * 0.85));
            } else if (budgetLevel === "High") {
                profit1 = profit1.replace(/\d+/g, m => Math.floor(parseInt(m) * 1.2));
                profit2 = profit2.replace(/\d+/g, m => Math.floor(parseInt(m) * 1.15));
            }

            // Calculate total profits
            const totalProfit1 = calculateTotalProfit(profit1, landSize);
            const totalProfit2 = calculateTotalProfit(profit2, landSize);
            const totalProfit3 = calculateTotalProfit(profit3, landSize);

            // Generate the report HTML
            const reportHTML = `
                <div class="report-header">
                    <i class="fas fa-chart-line"></i>
                    <h2>SMART CROP RECOMMENDATION REPORT</h2>
                    <span class="risk-badge">RISK ALERT</span>
                </div>
                
                <div class="location-summary">
                    <div class="location-item"><i class="fas fa-map-marker-alt"></i> <strong>Location:</strong> ${district}, ${village}</div>
                    <div class="location-item"><i class="fas fa-leaf"></i> <strong>Soil Type:</strong> ${soilType} Soil</div>
                    <div class="location-item"><i class="fas fa-sun"></i> <strong>Season:</strong> ${season}</div>
                    <div class="location-item"><i class="fas fa-tint"></i> <strong>Water Source:</strong> ${waterSource} (${waterLevel})</div>
                    <div class="location-item"><i class="fas fa-rupee-sign"></i> <strong>Budget Level:</strong> ${budgetLevel} Investment</div>
                    <div class="location-item"><i class="fas fa-chart-area"></i> <strong>Land Size:</strong> ${landSize} Acres</div>
                </div>
                
                <div class="section-title">
                    <i class="fas fa-check-circle"></i> TOP 3 RECOMMENDED CROPS
                </div>
                
                <div class="crops-grid">
                    <div class="crop-card">
                        <div class="crop-rank">1</div>
                        <div class="crop-name">${crop1}</div>
                        <div class="crop-detail"><span class="label"> Suitability:</span> <span class="value">${suitability1}%</span></div>
                        <div class="crop-detail"><span class="label"> Profit/Acre:</span> <span class="value">${profit1}</span></div>
                        <div class="crop-detail"><span class="label"> Total Profit:</span> <span class="value">${totalProfit1}</span></div>
                        <div class="crop-detail"><span class="label"> Risk Level:</span> <span class="value"><span class="risk-badge-${risk1.toLowerCase()}">${risk1}</span></span></div>
                        <div class="crop-detail"><span class="label"> Market:</span> <span class="value">${market1}</span></div>
                    </div>
                    
                    <div class="crop-card">
                        <div class="crop-rank">2</div>
                        <div class="crop-name">${crop2}</div>
                        <div class="crop-detail"><span class="label"> Suitability:</span> <span class="value">${suitability2}%</span></div>
                        <div class="crop-detail"><span class="label"> Profit/Acre:</span> <span class="value">${profit2}</span></div>
                        <div class="crop-detail"><span class="label"> Total Profit:</span> <span class="value">${totalProfit2}</span></div>
                        <div class="crop-detail"><span class="label"> Risk Level:</span> <span class="value"><span class="risk-badge-${risk2.toLowerCase()}">${risk2}</span></span></div>
                        <div class="crop-detail"><span class="label"> Market:</span> <span class="value">${market2}</span></div>
                    </div>
                    
                    <div class="crop-card">
                        <div class="crop-rank">3</div>
                        <div class="crop-name">${crop3}</div>
                        <div class="crop-detail"><span class="label"> Suitability:</span> <span class="value">${suitability3}%</span></div>
                        <div class="crop-detail"><span class="label"> Profit/Acre:</span> <span class="value">${profit3}</span></div>
                        <div class="crop-detail"><span class="label"> Total Profit:</span> <span class="value">${totalProfit3}</span></div>
                        <div class="crop-detail"><span class="label"> Risk Level:</span> <span class="value"><span class="risk-badge-${risk3.toLowerCase()}">${risk3}</span></span></div>
                        <div class="crop-detail"><span class="label"> Market:</span> <span class="value">${market3}</span></div>
                    </div>
                </div>
                
                <div class="section-title">
                    <i class="fas fa-exclamation-triangle"></i> REAL-TIME RISK ALERTS
                </div>
                
                <div class="alerts-list">
                    <div class="alert-item alert-orange">
                        <i class="fas fa-temperature-high"></i>
                        <span><strong> Weather Alert</strong>  Extreme heat may affect ${crop1} & ${crop2} yield next week.</span>
                    </div>
                    <div class="alert-item alert-yellow">
                        <i class="fas fa-cloud-sun"></i>
                        <span><strong> Climate Advisory</strong>  District climate-sensitive. Use heat-tolerant varieties.</span>
                    </div>
                    <div class="alert-item alert-yellow">
                        <i class="fas fa-chart-line"></i>
                        <span><strong> Market Alert</strong>  Price fluctuation possible for ${crop1} this season.</span>
                    </div>
                    <div class="alert-item alert-yellow">
                        <i class="fas fa-seedling"></i>
                        <span><strong> Input Alert</strong>  Verify seeds & fertilisers before purchase. Reports of low-quality inputs.</span>
                    </div>
                </div>
            `;

            document.getElementById('recommendationReport').innerHTML = reportHTML;
            document.getElementById('recommendationReport').style.display = 'block';
        }

        function calculateTotalProfit(profitRange, landSize) {
            const matches = profitRange.match(/(\d+,\d+)/g);
            if (!matches || matches.length < 2) return profitRange;

            const min = parseInt(matches[0].replace(/[,]/g, ''));
            const max = parseInt(matches[1].replace(/[,]/g, ''));

            const totalMin = min * landSize;
            const totalMax = max * landSize;

            return `${totalMin.toLocaleString()}  ${totalMax.toLocaleString()}`;
        }

        function resetRecommendationForm() {
            document.getElementById('villageSearchInput').value = '';
            document.getElementById('landSize').value = '5';
            document.getElementById('waterSourceInput').value = '';
            document.getElementById('waterLevelInput').value = '';
            document.getElementById('budgetInput').value = '';
            document.getElementById('soilInput').value = '';
            document.getElementById('recommendationReport').style.display = 'none';
        }

        // ============================================
        // AUTHENTICATION FUNCTIONS
        // ============================================
        function handleLogin() {
            const email = document.getElementById('email').value.trim();
            const password = document.getElementById('password').value.trim();
            const errorElement = document.getElementById('loginError');

            if (!email || !password) {
                errorElement.classList.add('show');
                return;
            }

            document.getElementById('loginPage').style.display = 'none';
            document.getElementById('mainApp').classList.add('authenticated');

            document.getElementById('profileUserName').textContent = email.split('@')[0];
            document.getElementById('profileUserEmail').textContent = email;

            // Update hero greeting
            if (document.getElementById('welcomeUserName')) {
                document.getElementById('welcomeUserName').textContent = email.split('@')[0];
            }

            updateDashboardStats();
            updateDistrictDropdowns();
            initCharts();
            renderProfitItems();
            renderYieldItems();
            loadGovernmentSchemes();
            updateChatbotFeatures();
        }

        function logout() {
            document.getElementById('loginPage').style.display = 'flex';
            document.getElementById('mainApp').classList.remove('authenticated');
            document.getElementById('email').value = '';
            document.getElementById('password').value = '';
            document.getElementById('loginError').classList.remove('show');
            showPage('dashboard');
        }

        // ============================================
        // CALCULATOR FUNCTIONS (simplified)
        // ============================================
        function calculateBasicProfit() {
            const crop = document.getElementById('cropSelect')?.value;
            const area = parseFloat(document.getElementById('areaInput')?.value);
            const yieldPerAcre = parseFloat(document.getElementById('yieldInput')?.value);
            const price = parseFloat(document.getElementById('priceInput')?.value);

            if (!crop || !area || !yieldPerAcre || !price) {
                alert(translations[currentLanguage]['alert_fill_fields']);
                return;
            }

            const totalExpenses = area * 20000;
            const totalYield = area * yieldPerAcre;
            const totalRevenue = totalYield * price;
            const totalProfit = totalRevenue - totalExpenses;
            const profitPerAcre = totalProfit / area;
            const roi = (totalProfit / totalExpenses) * 100;

            document.getElementById('resultsSection').style.display = 'block';

            const profitBadge = document.getElementById('profitBadge');
            profitBadge.className = totalProfit >= 0 ? 'profit-badge profit-positive' : 'profit-badge profit-negative';
            profitBadge.textContent = totalProfit >= 0 ? translations[currentLanguage]['profit'] : translations[currentLanguage]['loss'];

            document.getElementById('resultsGrid').innerHTML = `
                <div class="result-item"><div class="result-label">${translations[currentLanguage]['revenue']}</div><div class="result-value">${formatNumber(totalRevenue)}</div></div>
                <div class="result-item"><div class="result-label">${translations[currentLanguage]['expenses']}</div><div class="result-value">${formatNumber(totalExpenses)}</div></div>
                <div class="result-item"><div class="result-label">${translations[currentLanguage]['profit']}</div><div class="result-value ${totalProfit < 0 ? 'negative' : ''}">${formatNumber(totalProfit)}</div></div>
                <div class="result-item"><div class="result-label">${translations[currentLanguage]['profit_per_acre']}</div><div class="result-value ${profitPerAcre < 0 ? 'negative' : ''}">${formatNumber(profitPerAcre)}</div></div>
                <div class="result-item"><div class="result-label">ROI</div><div class="result-value ${roi < 0 ? 'negative' : ''}">${roi.toFixed(1)}%</div></div>
            `;
        }

        function resetBasicCalculator() {
            document.getElementById('areaInput').value = 1;
            document.getElementById('yieldInput').value = 8;
            document.getElementById('priceInput').value = 6500;
            document.getElementById('resultsSection').style.display = 'none';
        }

        function calculateAdvancedProfit() {
            const crop = document.getElementById('advancedCropSelect')?.value;
            const area = parseFloat(document.getElementById('advancedAreaInput')?.value);
            const yieldPerAcre = parseFloat(document.getElementById('advancedYieldInput')?.value);
            const price = parseFloat(document.getElementById('advancedPriceInput')?.value);
            const seeds = parseFloat(document.getElementById('seedsCost')?.value) || 0;
            const fertilizer = parseFloat(document.getElementById('fertilizerCost')?.value) || 0;
            const pesticide = parseFloat(document.getElementById('pesticideCost')?.value) || 0;
            const irrigation = parseFloat(document.getElementById('irrigationCost')?.value) || 0;
            const labor = parseFloat(document.getElementById('laborCost')?.value) || 0;
            const other = parseFloat(document.getElementById('otherCost')?.value) || 0;

            if (!crop || !area || !yieldPerAcre || !price) {
                alert(translations[currentLanguage]['alert_fill_fields']);
                return;
            }

            const expensesPerAcre = seeds + fertilizer + pesticide + irrigation + labor + other;
            const totalExpenses = area * expensesPerAcre;
            const totalYield = area * yieldPerAcre;
            const totalRevenue = totalYield * price;
            const totalProfit = totalRevenue - totalExpenses;
            const profitPerAcre = totalProfit / area;
            const roi = (totalProfit / totalExpenses) * 100;

            document.getElementById('advancedResultsSection').style.display = 'block';

            const advancedProfitBadge = document.getElementById('advancedProfitBadge');
            advancedProfitBadge.className = totalProfit >= 0 ? 'profit-badge profit-positive' : 'profit-badge profit-negative';
            advancedProfitBadge.textContent = totalProfit >= 0 ? translations[currentLanguage]['profit'] : translations[currentLanguage]['loss'];

            document.getElementById('advancedResultsGrid').innerHTML = `
                <div class="result-item"><div class="result-label">${translations[currentLanguage]['revenue']}</div><div class="result-value">${formatNumber(totalRevenue)}</div></div>
                <div class="result-item"><div class="result-label">${translations[currentLanguage]['expenses']}</div><div class="result-value">${formatNumber(totalExpenses)}</div></div>
                <div class="result-item"><div class="result-label">${translations[currentLanguage]['expense_breakdown']}</div><div class="result-value" style="font-size: 1rem;">
                    ${translations[currentLanguage]['label_seeds']}: ${formatNumber(seeds * area)}<br>
                    ${translations[currentLanguage]['label_fertilizer']}: ${formatNumber(fertilizer * area)}<br>
                    ${translations[currentLanguage]['label_pesticide']}: ${formatNumber(pesticide * area)}<br>
                    ${translations[currentLanguage]['label_irrigation']}: ${formatNumber(irrigation * area)}<br>
                    ${translations[currentLanguage]['label_labor']}: ${formatNumber(labor * area)}<br>
                    ${translations[currentLanguage]['label_other']}: ${formatNumber(other * area)}
                </div></div>
                <div class="result-item"><div class="result-label">${translations[currentLanguage]['profit']}</div><div class="result-value ${totalProfit < 0 ? 'negative' : ''}">${formatNumber(totalProfit)}</div></div>
                <div class="result-item"><div class="result-label">${translations[currentLanguage]['profit_per_acre']}</div><div class="result-value ${profitPerAcre < 0 ? 'negative' : ''}">${formatNumber(profitPerAcre)}</div></div>
                <div class="result-item"><div class="result-label">ROI</div><div class="result-value ${roi < 0 ? 'negative' : ''}">${roi.toFixed(1)}%</div></div>
            `;
        }

        function resetAdvancedCalculator() {
            document.getElementById('advancedAreaInput').value = 1;
            document.getElementById('advancedYieldInput').value = 8;
            document.getElementById('advancedPriceInput').value = 6500;
            document.getElementById('seedsCost').value = 2000;
            document.getElementById('fertilizerCost').value = 4500;
            document.getElementById('pesticideCost').value = 3000;
            document.getElementById('irrigationCost').value = 2500;
            document.getElementById('laborCost').value = 8000;
            document.getElementById('otherCost').value = 2000;
            document.getElementById('advancedResultsSection').style.display = 'none';
        }

        function compareCrops() {
            const crop1 = document.getElementById('crop1Select')?.value;
            const crop2 = document.getElementById('crop2Select')?.value;

            if (!crop1 || !crop2) {
                alert(translations[currentLanguage]['alert_select_two']);
                return;
            }
            if (crop1 === crop2) {
                alert(translations[currentLanguage]['alert_select_different']);
                return;
            }

            const container = document.getElementById('cropComparisonResults');
            if (container) {
                container.style.display = 'block';
                container.innerHTML = `
                    <h4 style="color: var(--dark-green); margin-bottom: 15px;">Crop Comparison Results</h4>
                    <table class="crop-comparison-table">
                        <thead>
                            <tr>
                                <th>Parameter</th>
                                <th>${crop1}</th>
                                <th>${crop2}</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>Yield per Acre</strong></td>
                                <td>10 quintals</td>
                                <td>10 quintals</td>
                            </tr>
                            <tr>
                                <td><strong>Price per Quintal</strong></td>
                                <td>6,500</td>
                                <td>5,000</td>
                            </tr>
                            <tr>
                                <td><strong>Revenue per Acre</strong></td>
                                <td>65,000</td>
                                <td>50,000</td>
                            </tr>
                            <tr>
                                <td><strong>Expenses per Acre</strong></td>
                                <td>20,000</td>
                                <td>20,000</td>
                            </tr>
                            <tr>
                                <td><strong>Profit per Acre</strong></td>
                                <td style="background: #e8f5e9;">45,000</td>
                                <td>30,000</td>
                            </tr>
                            <tr>
                                <td><strong>ROI</strong></td>
                                <td style="background: #e8f5e9;">225%</td>
                                <td>150%</td>
                            </tr>
                        </tbody>
                    </table>
                `;
            }
        }

        function formatNumber(num) {
            if (num >= 10000000) return (num / 10000000).toFixed(2) + ' Cr';
            else if (num >= 100000) return (num / 100000).toFixed(2) + ' L';
            else return num.toFixed(0).replace(/\B(?=(\d{3})+(?!\d))/g, ',');
        }

        // ============================================
        // MARKET FUNCTIONS
        // ============================================
        function searchMarkets() {
            const crop = document.getElementById('marketCropSelect')?.value;
            const state = document.getElementById('marketStateSelect')?.value;
            const date = document.getElementById('marketDate')?.value;

            let filteredData = marketData;
            if (crop) filteredData = filteredData.filter(item => item.crop === crop);
            if (state && state !== 'all') filteredData = filteredData.filter(item => item.state === state);
            if (date) filteredData = filteredData.filter(item => item.date === date);

            document.getElementById('marketsResults').style.display = 'block';

            const marketsTableBody = document.getElementById('marketsTableBody');
            if (filteredData.length > 0) {
                let html = '';
                filteredData.forEach(item => {
                    const changeClass = item.change.includes('+') ? 'price-up' : (item.change.includes('-') ? 'price-down' : 'price-stable');
                    html += `<tr>
                        <td>${item.market}</td>
                        <td>${item.crop}</td>
                        <td>${item.state}</td>
                        <td>${item.price}</td>
                        <td class="${changeClass}">${item.change}</td>
                        <td>${item.date}</td>
                    </tr>`;
                });
                marketsTableBody.innerHTML = html;
            } else {
                marketsTableBody.innerHTML = '<tr><td colspan="6" style="text-align: center; padding: 20px;">No market data found</td></tr>';
            }
        }

        function resetMarkets() {
            document.getElementById('marketCropSelect').value = 'Cotton';
            document.getElementById('marketStateSelect').value = 'all';
            document.getElementById('marketDate').value = '2024-03-15';
            document.getElementById('marketsResults').style.display = 'none';
        }

        // ============================================
        // GOVERNMENT SCHEMES
        // ============================================
        function loadGovernmentSchemes() {
            const container = document.getElementById('schemesGrid');
            if (!container) return;

            container.innerHTML = '';
            governmentSchemesData.forEach(scheme => {
                const card = document.createElement('div');
                card.className = 'scheme-card';
                card.innerHTML = `
                    <div class="scheme-icon"><i class="fas fa-hand-holding-usd"></i></div>
                    <div class="scheme-title">${scheme.title[currentLanguage]}</div>
                    <div class="scheme-description">${scheme.description[currentLanguage]}</div>
                    <div class="scheme-benefits">
                        <strong>${translations[currentLanguage]['benefits']}:</strong> ${scheme.benefits[currentLanguage]}
                    </div>
                    <button class="btn btn-primary" style="width: 100%;" onclick="alert('${translations[currentLanguage]['apply_clicked']}')">
                        <i class="fas fa-file-alt"></i> ${translations[currentLanguage]['btn_apply']}
                    </button>
                `;
                container.appendChild(card);
            });

            // Setup search
            const searchInput = document.getElementById('schemeSearchInput');
            const clearBtn = document.getElementById('clearSchemeSearch');

            if (searchInput) {
                searchInput.addEventListener('input', function () {
                    const term = this.value.toLowerCase();
                    const cards = document.querySelectorAll('.scheme-card');
                    let count = 0;

                    cards.forEach(card => {
                        const title = card.querySelector('.scheme-title')?.textContent.toLowerCase() || '';
                        if (title.includes(term)) {
                            card.style.display = 'block';
                            count++;
                        } else {
                            card.style.display = 'none';
                        }
                    });

                    document.getElementById('schemeSearchCount').textContent =
                        `${translations[currentLanguage]['showing_schemes']} (${count} of ${cards.length})`;

                    if (clearBtn) clearBtn.style.display = term ? 'block' : 'none';
                });
            }

            if (clearBtn) {
                clearBtn.addEventListener('click', function () {
                    if (searchInput) {
                        searchInput.value = '';
                        searchInput.dispatchEvent(new Event('input'));
                    }
                    this.style.display = 'none';
                });
            }
        }

        // ============================================
        // PROFILE FUNCTIONS (simplified)
        // ============================================
        function saveFarmerProfile() {
            const state = document.getElementById('profileState').value;
            const district = document.getElementById('profileDistrict').value;
            const landArea = document.getElementById('profileLandArea').value;
            const seedType = document.getElementById('profileSeedType').value;
            const cropType = document.getElementById('profileCropType').value;

            if (!state || !district || !landArea || !seedType || !cropType) {
                alert(translations[currentLanguage]['alert_fill_fields']);
                return;
            }

            const districtName = document.getElementById('profileDistrictSearchInput').value;

            farmerProfile = {
                state: "maharashtra",
                stateName: "Maharashtra",
                district: district,
                districtName: districtName,
                landArea: parseFloat(landArea),
                seedType: seedType,
                cropType: cropType
            };

            displaySavedProfile();
            document.getElementById('profileGraphsSection').style.display = 'block';
        }

        function displaySavedProfile() {
            if (!farmerProfile) return;

            const savedCard = document.getElementById('savedProfileCard');
            const savedInfo = document.getElementById('savedProfileInfo');

            savedInfo.innerHTML = `
                <div class="info-item">
                    <div class="info-label">State</div>
                    <div class="info-value">${farmerProfile.stateName}</div>
                </div>
                <div class="info-item">
                    <div class="info-label">District</div>
                    <div class="info-value">${farmerProfile.districtName}</div>
                </div>
                <div class="info-item">
                    <div class="info-label">Land Area</div>
                    <div class="info-value">${farmerProfile.landArea} acres</div>
                </div>
                <div class="info-item">
                    <div class="info-label">Seed Type</div>
                    <div class="info-value">${translations[currentLanguage]['seed_' + farmerProfile.seedType] || farmerProfile.seedType}</div>
                </div>
                <div class="info-item">
                    <div class="info-label">Crop Type</div>
                    <div class="info-value">${translations[currentLanguage]['crop_' + farmerProfile.cropType] || farmerProfile.cropType}</div>
                </div>
            `;

            savedCard.style.display = 'block';
        }

        function clearFarmerProfile() {
            document.getElementById('profileState').value = '';
            document.getElementById('profileDistrict').innerHTML = '<option value="">-- Select District --</option>';
            document.getElementById('profileLandArea').value = '1';
            document.getElementById('profileSeedType').value = '';
            document.getElementById('profileCropType').value = '';
            document.getElementById('savedProfileCard').style.display = 'none';
            document.getElementById('profileGraphsSection').style.display = 'none';
            farmerProfile = null;

            document.getElementById('profileStateSearchInput').value = '';
            document.getElementById('profileDistrictSearchInput').value = '';
            document.getElementById('profileDistrictSearchInput').disabled = true;
        }

        function goToDistrictFromProfile() {
            if (!farmerProfile) return;

            showPage('quickAnalysis');

            const districtInput = document.getElementById('districtSearchInput');
            const districtSelect = document.getElementById('quickDistrictSelect');

            districtInput.value = farmerProfile.districtName;
            districtSelect.value = farmerProfile.district;

            const event = new Event('change', { bubbles: true });
            districtSelect.dispatchEvent(event);

            setTimeout(() => {
                viewQuickDistrict();
            }, 500);
        }

        function fillCalculatorFromProfile() {
            if (!farmerProfile) return;

            showPage('calculator');

            const areaInput = document.getElementById('generalAreaInput');
            if (areaInput) {
                areaInput.value = farmerProfile.landArea;
            }
        }

        // ============================================
        // CHART FUNCTIONS
        // ============================================
        function initCharts() {
            initProfitChart();
            initYieldChart();
        }

        function initProfitChart() {
            const ctx = document.getElementById('profitChart')?.getContext('2d');
            if (!ctx) return;

            const labels = profitData.map(item => item.crop + ' (' + item.season + ')');
            const values = profitData.map(item => item.value);

            if (profitChart) profitChart.destroy();

            profitChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: labels,
                    datasets: [{
                        label: translations[currentLanguage]['profit_analysis'],
                        data: values,
                        backgroundColor: 'rgba(46, 125, 50, 0.7)',
                        borderColor: '#2e7d32',
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: { callback: value => '' + value.toLocaleString() }
                        }
                    }
                }
            });
        }

        function initYieldChart() {
            const ctx = document.getElementById('yieldChart')?.getContext('2d');
            if (!ctx) return;

            const labels = yieldData.map(item => item.crop + ' (' + item.season + ')');
            const values = yieldData.map(item => item.value);

            if (yieldChart) yieldChart.destroy();

            yieldChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: labels,
                    datasets: [{
                        label: translations[currentLanguage]['yield_analysis'],
                        data: values,
                        backgroundColor: 'rgba(255, 193, 7, 0.7)',
                        borderColor: '#ffc107',
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: { callback: value => value + ' qtl' }
                        }
                    }
                }
            });
        }

        function updateCharts() {
            if (profitChart) {
                profitChart.data.labels = profitData.map(item => item.crop + ' (' + item.season + ')');
                profitChart.data.datasets[0].data = profitData.map(item => item.value);
                profitChart.update();
            }
            if (yieldChart) {
                yieldChart.data.labels = yieldData.map(item => item.crop + ' (' + item.season + ')');
                yieldChart.data.datasets[0].data = yieldData.map(item => item.value);
                yieldChart.update();
            }
        }

        function renderProfitItems() {
            const container = document.getElementById('profitItems');
            if (!container) return;

            if (profitData.length === 0) {
                container.innerHTML = '<p style="color: var(--text-light); text-align: center; padding: 20px;">No profit data added yet.</p>';
                return;
            }

            let html = '';
            profitData.forEach((item, index) => {
                html += `
                    <div class="data-item">
                        <div class="data-info">
                            <span><i class="fas fa-seedling"></i> ${item.crop}</span>
                            <span><i class="fas fa-calendar"></i> ${item.season}</span>
                            <span><i class="fas fa-rupee-sign"></i> ${formatNumber(item.value)}</span>
                        </div>
                        <div class="data-actions">
                            <button class="delete-btn" onclick="deleteProfitItem(${index})" title="Delete">
                                <i class="fas fa-trash"></i> <span>Delete</span>
                            </button>
                        </div>
                    </div>
                `;
            });
            container.innerHTML = html;
        }

        function renderYieldItems() {
            const container = document.getElementById('yieldItems');
            if (!container) return;

            if (yieldData.length === 0) {
                container.innerHTML = '<p style="color: var(--text-light); text-align: center; padding: 20px;">No yield data added yet.</p>';
                return;
            }

            let html = '';
            yieldData.forEach((item, index) => {
                html += `
                    <div class="data-item">
                        <div class="data-info">
                            <span><i class="fas fa-seedling"></i> ${item.crop}</span>
                            <span><i class="fas fa-calendar"></i> ${item.season}</span>
                            <span><i class="fas fa-weight"></i> ${item.value} qtl</span>
                        </div>
                        <div class="data-actions">
                            <button class="delete-btn" onclick="deleteYieldItem(${index})" title="Delete">
                                <i class="fas fa-trash"></i> <span>Delete</span>
                            </button>
                        </div>
                    </div>
                `;
            });
            container.innerHTML = html;
        }

        function deleteProfitItem(index) {
            profitData.splice(index, 1);
            updateCharts();
            renderProfitItems();
            document.getElementById('profitAnalysis').style.display = 'none';
        }

        function deleteYieldItem(index) {
            yieldData.splice(index, 1);
            updateCharts();
            renderYieldItems();
            document.getElementById('yieldAnalysis').style.display = 'none';
        }

        function showProfitDataForm() {
            document.getElementById('profitDataForm').style.display = 'block';
        }

        function saveProfitData() {
            const crop = document.getElementById('profitCropName').value.trim();
            const season = document.getElementById('profitSeason').value;
            const value = parseFloat(document.getElementById('profitValue').value);

            if (!crop || !value) {
                alert(translations[currentLanguage]['alert_fill_fields']);
                return;
            }

            profitData.push({ crop: crop, season: season, value: value });
            updateCharts();
            renderProfitItems();
            cancelProfitData();
        }

        function cancelProfitData() {
            document.getElementById('profitDataForm').style.display = 'none';
            document.getElementById('profitCropName').value = '';
            document.getElementById('profitSeason').value = 'Kharif';
            document.getElementById('profitValue').value = '50000';
        }

        function showYieldDataForm() {
            document.getElementById('yieldDataForm').style.display = 'block';
        }

        function saveYieldData() {
            const crop = document.getElementById('yieldCropName').value.trim();
            const season = document.getElementById('yieldSeason').value;
            const value = parseFloat(document.getElementById('yieldValue').value);

            if (!crop || !value) {
                alert(translations[currentLanguage]['alert_fill_fields']);
                return;
            }

            yieldData.push({ crop: crop, season: season, value: value });
            updateCharts();
            renderYieldItems();
            cancelYieldData();
        }

        function cancelYieldData() {
            document.getElementById('yieldDataForm').style.display = 'none';
            document.getElementById('yieldCropName').value = '';
            document.getElementById('yieldSeason').value = 'Kharif';
            document.getElementById('yieldValue').value = '50';
        }

        function analyzeProfitData() {
            if (profitData.length === 0) {
                alert('No data to analyze');
                return;
            }

            const values = profitData.map(item => item.value);
            const avg = values.reduce((a, b) => a + b, 0) / values.length;
            const highest = Math.max(...values);
            const lowest = Math.min(...values);

            document.getElementById('profitAnalysis').style.display = 'block';
            document.getElementById('profitStats').innerHTML = `
                <div class="stat-item">
                    <div class="stat-label">Average</div>
                    <div class="stat-value">${formatNumber(avg)}</div>
                </div>
                <div class="stat-item">
                    <div class="stat-label">Highest</div>
                    <div class="stat-value">${formatNumber(highest)}</div>
                </div>
                <div class="stat-item">
                    <div class="stat-label">Lowest</div>
                    <div class="stat-value">${formatNumber(lowest)}</div>
                </div>
            `;
        }

        function analyzeYieldData() {
            if (yieldData.length === 0) {
                alert('No data to analyze');
                return;
            }

            const values = yieldData.map(item => item.value);
            const avg = values.reduce((a, b) => a + b, 0) / values.length;
            const highest = Math.max(...values);
            const lowest = Math.min(...values);

            document.getElementById('yieldAnalysis').style.display = 'block';
            document.getElementById('yieldStats').innerHTML = `
                <div class="stat-item">
                    <div class="stat-label">Average</div>
                    <div class="stat-value">${avg.toFixed(1)} <small>qtl</small></div>
                </div>
                <div class="stat-item">
                    <div class="stat-label">Highest</div>
                    <div class="stat-value">${highest} <small>qtl</small></div>
                </div>
                <div class="stat-item">
                    <div class="stat-label">Lowest</div>
                    <div class="stat-value">${lowest} <small>qtl</small></div>
                </div>
            `;
        }

        // ============================================
        // CHATBOT FUNCTIONS
        // ============================================
        function toggleChatbot() {
            const win = document.getElementById('chatbotWindow');
            const btn = document.getElementById('openChatbot');
            if (win && btn) {
                if (win.style.display === 'flex') {
                    win.style.display = 'none';
                    btn.innerHTML = '<i class="fas fa-robot"></i>';
                    chatbotMode = null;
                } else {
                    win.style.display = 'flex';
                    btn.innerHTML = '<i class="fas fa-times"></i>';
                }
            }
        }

        function sendChatbotMessage() {
            const input = document.getElementById('chatbotInput');
            if (!input || !input.value.trim()) return;

            addChatMessage(input.value.trim(), 'user');
            input.value = '';

            setTimeout(() => {
                const responses = [
                    "I can help you with crop recommendations for your village! Just go to Maharashtra Crop Advisor.",
                    "You can ask me about government schemes like PM-KISAN or PMFBY.",
                    "Would you like to compare market prices for different crops?",
                    "Try our profit calculator to estimate your returns.",
                    "Based on your soil type and water availability, I can suggest suitable crops."
                ];
                const randomResponse = responses[Math.floor(Math.random() * responses.length)];
                addChatMessage(randomResponse, 'bot');
            }, 1000);
        }

        function addChatMessage(msg, sender) {
            const body = document.getElementById('chatbotBody');
            if (!body) return;
            const div = document.createElement('div');
            div.className = `chat-message ${sender}-message`;
            div.textContent = msg;
            body.appendChild(div);
            body.scrollTop = body.scrollHeight;
        }

        function updateChatbotFeatures() {
            const container = document.getElementById('chatbotFeaturesList');
            if (!container) return;

            const features = [
                { num: 1, text: "Maharashtra Crop Advisor - Get personalized recommendations", feat: 'quick' },
                { num: 2, text: "Government Schemes - View all schemes", feat: 'schemes' },
                { num: 3, text: "Market Prices - Compare crop prices", feat: 'markets' },
                { num: 4, text: "Profit Calculator - Calculate your returns", feat: 'calculator' }
            ];

            container.innerHTML = features.map(f => `
                <div class="feature-item" onclick="handleChatbotFeature('${f.feat}')">
                    <div class="feature-number">${f.num}</div>
                    <div class="feature-text">${f.text}</div>
                </div>
            `).join('');
        }

        function handleChatbotFeature(feature) {
            toggleChatbot();
            if (feature === 'quick') showPage('quickAnalysis');
            if (feature === 'schemes') showPage('governmentSchemes');
            if (feature === 'markets') showPage('markets');
            if (feature === 'calculator') showPage('calculator');
        }

        function updateChatbotWelcome() {
            const welcome = document.querySelector('.chatbot-body .bot-message span');
            if (welcome) welcome.textContent = translations[currentLanguage]['chat_welcome'];
        }

        // ============================================
        // INITIALIZATION
        // ============================================
        document.addEventListener('DOMContentLoaded', function () {
            document.getElementById('openChatbot')?.addEventListener('click', toggleChatbot);
            document.getElementById('closeChatbot')?.addEventListener('click', toggleChatbot);
            document.getElementById('sendChatbotMessage')?.addEventListener('click', sendChatbotMessage);
            document.getElementById('chatbotInput')?.addEventListener('keypress', function (e) {
                if (e.key === 'Enter') sendChatbotMessage();
            });
            document.getElementById('searchMarketsBtn')?.addEventListener('click', searchMarkets);
            document.getElementById('resetMarketsBtn')?.addEventListener('click', resetMarkets);

            // Tab switching for calculators
            document.querySelectorAll('.calculator-tabs .tab-btn').forEach(btn => {
                btn.addEventListener('click', function () {
                    document.querySelectorAll('.calculator-tabs .tab-btn').forEach(b => b.classList.remove('active'));
                    document.querySelectorAll('#profitCalculator .tab-content').forEach(c => c.classList.remove('active'));
                    this.classList.add('active');
                    document.getElementById(this.dataset.tab + 'Tab').classList.add('active');
                });
            });

            document.querySelectorAll('.calculator-tabs-container .tab-btn').forEach(btn => {
                btn.addEventListener('click', function () {
                    document.querySelectorAll('.calculator-tabs-container .tab-btn').forEach(b => b.classList.remove('active'));
                    document.querySelectorAll('#calculatorPage .tab-content').forEach(c => c.classList.remove('active'));
                    this.classList.add('active');
                    document.getElementById(this.dataset.tab).classList.add('active');
                });
            });

            // Calculator buttons
            document.getElementById('calculateBtn')?.addEventListener('click', calculateBasicProfit);
            document.getElementById('resetBtn')?.addEventListener('click', resetBasicCalculator);
            document.getElementById('advancedCalculateBtn')?.addEventListener('click', calculateAdvancedProfit);
            document.getElementById('advancedResetBtn')?.addEventListener('click', resetAdvancedCalculator);
            document.getElementById('compareCropsBtn')?.addEventListener('click', compareCrops);

            document.getElementById('generalCalculateBtn')?.addEventListener('click', calculateBasicProfit);
            document.getElementById('generalResetBtn')?.addEventListener('click', resetBasicCalculator);
            document.getElementById('advancedGeneralCalculateBtn')?.addEventListener('click', calculateAdvancedProfit);
            document.getElementById('advancedGeneralResetBtn')?.addEventListener('click', resetAdvancedCalculator);

            changeLanguage('en');
            changeLoginLanguage('en');
            document.getElementById('mainApp').classList.remove('authenticated');
            document.getElementById('loginPage').style.display = 'flex';
            updateChatbotFeatures();
            updateDistrictDropdowns();
        });
    </script>

    <!-- Firebase SDK (kept but not used) -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>
    <script>
        const firebaseConfig = {
            apiKey: "AIzaSyDJV_oJyD_rYf6GKRVgC4JWKdzsGeRdIIA",
            authDomain: "agrosmart-6fa3f.firebaseapp.com",
            databaseURL: "https://agrosmart-6fa3f-default-rtdb.firebaseio.com",
            projectId: "agrosmart-6fa3f",
            storageBucket: "agrosmart-6fa3f.firebasestorage.app",
            messagingSenderId: "260123229951",
            appId: "1:260123229951:web:8a223e7a3ec7f5eb8c16ca"
        };
        firebase.initializeApp(firebaseConfig);
    </script>
</body>

</html>